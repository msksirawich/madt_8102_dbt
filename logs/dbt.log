[0m20:28:05.385364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc2f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcc6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcc7210>]}


============================== 20:28:05.388950 | 29b30002-ee40-453f-8426-34e149c4e323 ==============================
[0m20:28:05.388950 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:28:05.389331 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/Users/sirawich/.dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'debug': 'False'}
[0m20:28:05.398746 [info ] [MainThread]: dbt version: 1.10.10
[0m20:28:05.399010 [info ] [MainThread]: python version: 3.11.12
[0m20:28:05.399219 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:28:05.399562 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:28:05.399766 [info ] [MainThread]: Using profiles dir at /Users/sirawich/.dbt
[0m20:28:05.399922 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/.dbt/profiles.yml
[0m20:28:05.400055 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:28:05.462637 [info ] [MainThread]: Configuration:
[0m20:28:05.462935 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:28:05.463078 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:28:05.463203 [info ] [MainThread]: Required dependencies:
[0m20:28:05.463394 [debug] [MainThread]: Executing "git --help"
[0m20:28:05.486885 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:28:05.487532 [debug] [MainThread]: STDERR: "b''"
[0m20:28:05.487733 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:28:05.487911 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:28:05.488059 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:28:05.488236 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:28:05.490063 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14923237, "process_in_blocks": "0", "process_kernel_time": 0.195698, "process_mem_max_rss": "123125760", "process_out_blocks": "0", "process_user_time": 0.877434}
[0m20:28:05.490337 [debug] [MainThread]: Command `dbt debug` failed at 20:28:05.490278 after 0.15 seconds
[0m20:28:05.490651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104713fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd68ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b500c50>]}
[0m20:28:05.490936 [debug] [MainThread]: Flushing usage events
[0m20:28:07.019947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:52.491153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be74750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1b2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd86cd0>]}


============================== 20:29:52.494221 | 8b12f3eb-ff36-40df-9600-dd775b268c14 ==============================
[0m20:29:52.494221 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:29:52.494548 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/Users/sirawich/.dbt', 'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True'}
[0m20:29:52.503217 [info ] [MainThread]: dbt version: 1.10.10
[0m20:29:52.503454 [info ] [MainThread]: python version: 3.11.12
[0m20:29:52.503615 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:29:52.503751 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:29:52.503908 [info ] [MainThread]: Using profiles dir at /Users/sirawich/.dbt
[0m20:29:52.504051 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/.dbt/profiles.yml
[0m20:29:52.504176 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:29:52.566304 [info ] [MainThread]: Configuration:
[0m20:29:52.566619 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:29:52.566764 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:29:52.566888 [info ] [MainThread]: Required dependencies:
[0m20:29:52.567067 [debug] [MainThread]: Executing "git --help"
[0m20:29:52.588441 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:29:52.589098 [debug] [MainThread]: STDERR: "b''"
[0m20:29:52.589302 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:29:52.589479 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:29:52.589629 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:29:52.589766 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:29:52.591531 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14130788, "process_in_blocks": "0", "process_kernel_time": 0.184042, "process_mem_max_rss": "123420672", "process_out_blocks": "0", "process_user_time": 0.835164}
[0m20:29:52.591798 [debug] [MainThread]: Command `dbt debug` failed at 20:29:52.591747 after 0.14 seconds
[0m20:29:52.592085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b07150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f5110>]}
[0m20:29:52.592345 [debug] [MainThread]: Flushing usage events
[0m20:29:54.384526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:59.162262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bceb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd82d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd835d0>]}


============================== 20:30:59.165241 | 46dba1e3-cd2c-4673-9e3b-faf536247c79 ==============================
[0m20:30:59.165241 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:30:59.165564 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profile dbt_duckdb', 'profiles_dir': '/Users/sirawich/.dbt', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True'}
[0m20:30:59.174070 [info ] [MainThread]: dbt version: 1.10.10
[0m20:30:59.174307 [info ] [MainThread]: python version: 3.11.12
[0m20:30:59.174464 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:30:59.174595 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:30:59.174739 [info ] [MainThread]: Using profiles dir at /Users/sirawich/.dbt
[0m20:30:59.174876 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/.dbt/profiles.yml
[0m20:30:59.174998 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:30:59.234946 [info ] [MainThread]: Configuration:
[0m20:30:59.235266 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:30:59.235407 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:30:59.235533 [info ] [MainThread]: Required dependencies:
[0m20:30:59.235717 [debug] [MainThread]: Executing "git --help"
[0m20:30:59.252407 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:30:59.252980 [debug] [MainThread]: STDERR: "b''"
[0m20:30:59.253157 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:30:59.253317 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:30:59.253460 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:30:59.253584 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:30:59.255243 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13457566, "process_in_blocks": "0", "process_kernel_time": 0.181876, "process_mem_max_rss": "123633664", "process_out_blocks": "0", "process_user_time": 0.831797}
[0m20:30:59.255516 [debug] [MainThread]: Command `dbt debug` failed at 20:30:59.255461 after 0.13 seconds
[0m20:30:59.255848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ec150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5fd50>]}
[0m20:30:59.256138 [debug] [MainThread]: Flushing usage events
[0m20:31:00.713321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:32:43.967060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1cf390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e25ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de3f010>]}


============================== 20:32:43.970360 | d35cc591-9eef-4723-8a8e-70b033f8301a ==============================
[0m20:32:43.970360 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:32:43.970695 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt debug --profile dbt_duckdb', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'empty': 'None', 'target_path': 'None', 'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m20:32:43.979713 [info ] [MainThread]: dbt version: 1.10.10
[0m20:32:43.979976 [info ] [MainThread]: python version: 3.11.12
[0m20:32:43.980154 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:32:43.980302 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:32:43.980463 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/dbt
[0m20:32:43.980606 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml
[0m20:32:43.980738 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:32:44.044316 [info ] [MainThread]: Configuration:
[0m20:32:44.044623 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:32:44.044767 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:32:44.044893 [info ] [MainThread]: Required dependencies:
[0m20:32:44.045078 [debug] [MainThread]: Executing "git --help"
[0m20:32:44.063722 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:32:44.064334 [debug] [MainThread]: STDERR: "b''"
[0m20:32:44.064530 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:32:44.064706 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:32:44.064936 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:32:44.065119 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:32:44.066928 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.14291541, "process_in_blocks": "0", "process_kernel_time": 0.186272, "process_mem_max_rss": "123699200", "process_out_blocks": "0", "process_user_time": 0.867899}
[0m20:32:44.067268 [debug] [MainThread]: Command `dbt debug` failed at 20:32:44.067206 after 0.14 seconds
[0m20:32:44.067559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c47f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e27fcd0>]}
[0m20:32:44.067807 [debug] [MainThread]: Flushing usage events
[0m20:32:45.530474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:04.333382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e57b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e612290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e612b50>]}


============================== 20:33:04.335856 | d997f8f7-57c8-4225-b1d6-aa8c39faa54b ==============================
[0m20:33:04.335856 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:33:04.336163 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/dbt', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True'}
[0m20:33:04.341003 [info ] [MainThread]: dbt version: 1.10.10
[0m20:33:04.341203 [info ] [MainThread]: python version: 3.11.12
[0m20:33:04.341356 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:33:04.341486 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:33:04.341626 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/dbt
[0m20:33:04.341764 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml
[0m20:33:04.341885 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:33:04.402960 [info ] [MainThread]: Configuration:
[0m20:33:04.403259 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:33:04.403411 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:33:04.403546 [info ] [MainThread]: Required dependencies:
[0m20:33:04.403741 [debug] [MainThread]: Executing "git --help"
[0m20:33:04.419320 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:33:04.419885 [debug] [MainThread]: STDERR: "b''"
[0m20:33:04.420078 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:33:04.420243 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:33:04.420390 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:33:04.420531 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:33:04.422262 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1306908, "process_in_blocks": "0", "process_kernel_time": 0.162036, "process_mem_max_rss": "123781120", "process_out_blocks": "0", "process_user_time": 0.837419}
[0m20:33:04.422523 [debug] [MainThread]: Command `dbt debug` failed at 20:33:04.422465 after 0.13 seconds
[0m20:33:04.422835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e3abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e714bd0>]}
[0m20:33:04.423103 [debug] [MainThread]: Flushing usage events
[0m20:33:06.430462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:53.149652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc7f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd16890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcf6cd0>]}


============================== 20:33:53.152175 | fe68076e-e917-44a2-b754-ecaa9d72e64a ==============================
[0m20:33:53.152175 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:33:53.152479 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/dbt', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'use_colors': 'True', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug'}
[0m20:33:53.157431 [info ] [MainThread]: dbt version: 1.10.10
[0m20:33:53.157630 [info ] [MainThread]: python version: 3.11.12
[0m20:33:53.157785 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:33:53.157916 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:33:53.158059 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/dbt
[0m20:33:53.158200 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml
[0m20:33:53.158339 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:33:53.217877 [info ] [MainThread]: Configuration:
[0m20:33:53.218180 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:33:53.218322 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:33:53.218449 [info ] [MainThread]: Required dependencies:
[0m20:33:53.218631 [debug] [MainThread]: Executing "git --help"
[0m20:33:53.233823 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:33:53.234348 [debug] [MainThread]: STDERR: "b''"
[0m20:33:53.234532 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:33:53.234698 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:33:53.234832 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:33:53.234973 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:33:53.236604 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12566262, "process_in_blocks": "0", "process_kernel_time": 0.154469, "process_mem_max_rss": "123322368", "process_out_blocks": "0", "process_user_time": 0.813148}
[0m20:33:53.236843 [debug] [MainThread]: Command `dbt debug` failed at 20:33:53.236787 after 0.13 seconds
[0m20:33:53.237128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb1950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdb1b10>]}
[0m20:33:53.237387 [debug] [MainThread]: Flushing usage events
[0m20:33:54.769839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:32.253496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7d37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d86acd0>]}


============================== 20:34:32.255996 | 8b5a7778-7509-4eb0-9d31-068ca175e497 ==============================
[0m20:34:32.255996 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:34:32.256298 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/dbt', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'empty': 'None', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m20:34:32.261414 [info ] [MainThread]: dbt version: 1.10.10
[0m20:34:32.261612 [info ] [MainThread]: python version: 3.11.12
[0m20:34:32.261763 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:34:32.261891 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:34:32.262030 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/dbt
[0m20:34:32.262163 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml
[0m20:34:32.262282 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:34:32.322008 [info ] [MainThread]: Configuration:
[0m20:34:32.322313 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:34:32.322452 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:34:32.322577 [info ] [MainThread]: Required dependencies:
[0m20:34:32.322758 [debug] [MainThread]: Executing "git --help"
[0m20:34:32.338073 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:34:32.338626 [debug] [MainThread]: STDERR: "b''"
[0m20:34:32.338808 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:34:32.338972 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:34:32.339110 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:34:32.339238 [info ] [MainThread]: dbt looked for a profiles.yml file in /Users/sirawich/Documents/lab_lakehouse/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:34:32.340935 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.12707958, "process_in_blocks": "0", "process_kernel_time": 0.161841, "process_mem_max_rss": "123781120", "process_out_blocks": "0", "process_user_time": 0.828967}
[0m20:34:32.341193 [debug] [MainThread]: Command `dbt debug` failed at 20:34:32.341135 after 0.13 seconds
[0m20:34:32.341523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d43f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109167f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d819ad0>]}
[0m20:34:32.341775 [debug] [MainThread]: Flushing usage events
[0m20:34:34.185061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:26.611346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6dfa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a702650>]}


============================== 20:35:26.613803 | 076e1999-ea36-475b-abd8-82e860b1193a ==============================
[0m20:35:26.613803 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:35:26.614142 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m20:35:26.619276 [info ] [MainThread]: dbt version: 1.10.10
[0m20:35:26.619497 [info ] [MainThread]: python version: 3.11.12
[0m20:35:26.619653 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m20:35:26.619791 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m20:35:27.161353 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/medallion_project
[0m20:35:27.161694 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/profiles.yml
[0m20:35:27.161836 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m20:35:27.163181 [info ] [MainThread]: adapter type: duckdb
[0m20:35:27.163330 [info ] [MainThread]: adapter version: 1.9.6
[0m20:35:27.223659 [info ] [MainThread]: Configuration:
[0m20:35:27.223969 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:35:27.224120 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:35:27.224251 [info ] [MainThread]: Required dependencies:
[0m20:35:27.224441 [debug] [MainThread]: Executing "git --help"
[0m20:35:27.241224 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:35:27.241893 [debug] [MainThread]: STDERR: "b''"
[0m20:35:27.242102 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:35:27.242287 [info ] [MainThread]: Connection:
[0m20:35:27.242496 [info ] [MainThread]:   database: medallion
[0m20:35:27.242628 [info ] [MainThread]:   schema: main
[0m20:35:27.242758 [info ] [MainThread]:   path: dbt_duckdb/medallion.duckdb
[0m20:35:27.242915 [info ] [MainThread]:   config_options: None
[0m20:35:27.243041 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 'json']
[0m20:35:27.243163 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'temp_directory': '/tmp/duckdb_temp'}
[0m20:35:27.243283 [info ] [MainThread]:   external_root: .
[0m20:35:27.243399 [info ] [MainThread]:   use_credential_provider: None
[0m20:35:27.243514 [info ] [MainThread]:   attach: None
[0m20:35:27.243624 [info ] [MainThread]:   filesystems: None
[0m20:35:27.243750 [info ] [MainThread]:   remote: None
[0m20:35:27.243860 [info ] [MainThread]:   plugins: None
[0m20:35:27.243974 [info ] [MainThread]:   disable_transactions: False
[0m20:35:27.244334 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m20:35:27.307422 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:35:27.343567 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:35:27.343804 [debug] [MainThread]: On debug: select 1 as id
[0m20:35:27.343948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:27.350818 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m20:35:27.351049 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m20:35:27.351280 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:35:27.351449 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:35:27.351583 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Cannot open file "/Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_duckdb/medallion.duckdb": No such file or directory

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:35:27.353221 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.7815994, "process_in_blocks": "0", "process_kernel_time": 0.219337, "process_mem_max_rss": "143343616", "process_out_blocks": "0", "process_user_time": 0.95843}
[0m20:35:27.353467 [debug] [MainThread]: Command `dbt debug` failed at 20:35:27.353418 after 0.78 seconds
[0m20:35:27.353652 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:35:27.353833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a989b50>]}
[0m20:35:27.354035 [debug] [MainThread]: Flushing usage events
[0m20:35:29.481144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:44.935150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d957910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d957650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9f2790>]}


============================== 21:12:44.937864 | be13071a-3464-4280-bef5-d4b413e6e6be ==============================
[0m21:12:44.937864 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:12:44.938172 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'quiet': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True'}
[0m21:12:44.942912 [info ] [MainThread]: dbt version: 1.10.10
[0m21:12:44.943111 [info ] [MainThread]: python version: 3.11.12
[0m21:12:44.943261 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m21:12:44.943392 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m21:12:45.006297 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/medallion_project
[0m21:12:45.006631 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/profiles.yml
[0m21:12:45.006781 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m21:12:45.007793 [info ] [MainThread]: adapter type: duckdb
[0m21:12:45.007936 [info ] [MainThread]: adapter version: 1.9.6
[0m21:12:45.065657 [info ] [MainThread]: Configuration:
[0m21:12:45.066082 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:12:45.066259 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:12:45.066393 [info ] [MainThread]: Required dependencies:
[0m21:12:45.066597 [debug] [MainThread]: Executing "git --help"
[0m21:12:45.082524 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:12:45.083090 [debug] [MainThread]: STDERR: "b''"
[0m21:12:45.083278 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:12:45.083475 [info ] [MainThread]: Connection:
[0m21:12:45.083660 [info ] [MainThread]:   database: medallion
[0m21:12:45.083777 [info ] [MainThread]:   schema: main
[0m21:12:45.083897 [info ] [MainThread]:   path: dbt_duckdb/medallion.duckdb
[0m21:12:45.084015 [info ] [MainThread]:   config_options: None
[0m21:12:45.084133 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 'json']
[0m21:12:45.084250 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'temp_directory': '/tmp/duckdb_temp'}
[0m21:12:45.084360 [info ] [MainThread]:   external_root: .
[0m21:12:45.084471 [info ] [MainThread]:   use_credential_provider: None
[0m21:12:45.084584 [info ] [MainThread]:   attach: None
[0m21:12:45.084694 [info ] [MainThread]:   filesystems: None
[0m21:12:45.084808 [info ] [MainThread]:   remote: None
[0m21:12:45.084925 [info ] [MainThread]:   plugins: None
[0m21:12:45.085036 [info ] [MainThread]:   disable_transactions: False
[0m21:12:45.085382 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:12:45.131011 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:12:45.154362 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:12:45.154606 [debug] [MainThread]: On debug: select 1 as id
[0m21:12:45.154759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:45.157728 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m21:12:45.157897 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m21:12:45.158128 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:12:45.158296 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:12:45.158428 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  IO Error: Cannot open file "/Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_duckdb/medallion.duckdb": No such file or directory

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:12:45.159917 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.2650079, "process_in_blocks": "0", "process_kernel_time": 0.19871, "process_mem_max_rss": "143753216", "process_out_blocks": "0", "process_user_time": 0.918568}
[0m21:12:45.160147 [debug] [MainThread]: Command `dbt debug` failed at 21:12:45.160091 after 0.27 seconds
[0m21:12:45.160323 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:12:45.160507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd179d0>]}
[0m21:12:45.160713 [debug] [MainThread]: Flushing usage events
[0m21:12:49.383600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:17.743475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4def50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a576bd0>]}


============================== 21:15:17.746687 | a8faea4e-5451-42f1-bf17-c82b34ca3c95 ==============================
[0m21:15:17.746687 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:15:17.747021 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'introspect': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default'}
[0m21:15:17.755876 [info ] [MainThread]: dbt version: 1.10.10
[0m21:15:17.756157 [info ] [MainThread]: python version: 3.11.12
[0m21:15:17.756332 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m21:15:17.756480 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit
[0m21:15:17.838713 [info ] [MainThread]: Using profiles dir at /Users/sirawich/Documents/lab_lakehouse/medallion_project
[0m21:15:17.839049 [info ] [MainThread]: Using profiles.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/profiles.yml
[0m21:15:17.839245 [info ] [MainThread]: Using dbt_project.yml file at /Users/sirawich/Documents/lab_lakehouse/medallion_project/dbt_project.yml
[0m21:15:17.840787 [info ] [MainThread]: adapter type: duckdb
[0m21:15:17.841056 [info ] [MainThread]: adapter version: 1.9.6
[0m21:15:17.899466 [info ] [MainThread]: Configuration:
[0m21:15:17.899778 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:15:17.899920 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:15:17.900045 [info ] [MainThread]: Required dependencies:
[0m21:15:17.900236 [debug] [MainThread]: Executing "git --help"
[0m21:15:17.915432 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:15:17.915988 [debug] [MainThread]: STDERR: "b''"
[0m21:15:17.916180 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:15:17.916345 [info ] [MainThread]: Connection:
[0m21:15:17.916529 [info ] [MainThread]:   database: medallion
[0m21:15:17.916652 [info ] [MainThread]:   schema: main
[0m21:15:17.916774 [info ] [MainThread]:   path: /Users/sirawich/Documents/lab_lakehouse/dbt_duckdb/medallion.duckdb
[0m21:15:17.916894 [info ] [MainThread]:   config_options: None
[0m21:15:17.917013 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 'json']
[0m21:15:17.917129 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'temp_directory': '/tmp/duckdb_temp'}
[0m21:15:17.917241 [info ] [MainThread]:   external_root: .
[0m21:15:17.917358 [info ] [MainThread]:   use_credential_provider: None
[0m21:15:17.917468 [info ] [MainThread]:   attach: None
[0m21:15:17.917580 [info ] [MainThread]:   filesystems: None
[0m21:15:17.917696 [info ] [MainThread]:   remote: None
[0m21:15:17.917809 [info ] [MainThread]:   plugins: None
[0m21:15:17.917934 [info ] [MainThread]:   disable_transactions: False
[0m21:15:17.918253 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:15:17.967571 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m21:15:17.993703 [debug] [MainThread]: Using duckdb connection "debug"
[0m21:15:17.993983 [debug] [MainThread]: On debug: select 1 as id
[0m21:15:17.994137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:44.847196 [error] [MainThread]: Encountered an error:

[0m21:16:44.852045 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 420, in debug
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 144, in run
    connection_status = self.test_connection()
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 465, in test_connection
    connection_result = self.attempt_connection(self.profile)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/debug.py", line 443, in attempt_connection
    adapter.debug_query()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/duckdb/impl.py", line 113, in debug_query
    self.execute("select 1 as id")
  File "/opt/homebrew/lib/python3.11/site-packages/dbt_common/record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/base/impl.py", line 449, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/duckdb/connections.py", line 133, in execute
    return super().execute(sql, auto_begin, fetch, limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 219, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    cursor = connection.handle.cursor()
             ^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 96, in handle
    self._handle.resolve(self)
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/contracts/connection.py", line 120, in resolve
    return self.opener(connection)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/duckdb/connections.py", line 53, in open
    connection.handle = cls._ENV.handle()
                        ^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/duckdb/environments/local.py", line 75, in handle
    self.conn = self.initialize_db(self.creds, self._plugins)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/adapters/duckdb/environments/__init__.py", line 165, in initialize_db
    conn.install_extension(extension)
KeyboardInterrupt

[0m21:16:44.854762 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 87.15416, "process_in_blocks": "0", "process_kernel_time": 0.64633, "process_mem_max_rss": "242057216", "process_out_blocks": "0", "process_user_time": 18.230165}
[0m21:16:44.855167 [debug] [MainThread]: Command `dbt debug` failed at 21:16:44.855098 after 87.15 seconds
[0m21:16:44.855509 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:16:44.855804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100eb2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a730bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a593d10>]}
[0m21:16:44.856098 [debug] [MainThread]: Flushing usage events
[0m21:16:46.749612 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:20:46.811341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0060d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a007950>]}


============================== 21:20:46.814290 | 00226601-1735-4d44-aad8-44042fce248e ==============================
[0m21:20:46.814290 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:20:46.814605 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'use_colors': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select silver', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m21:20:47.036737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928a110>]}
[0m21:20:47.073712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1473d0>]}
[0m21:20:47.075536 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:20:47.128505 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:20:47.129040 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:20:47.129283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ed950>]}
[0m21:20:47.704827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a646610>]}
[0m21:20:47.739754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/manifest.json
[0m21:20:47.741236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/semantic_manifest.json
[0m21:20:47.754256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa0fc50>]}
[0m21:20:47.754587 [info ] [MainThread]: Found 2 models, 4 data tests, 431 macros
[0m21:20:47.754772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00226601-1735-4d44-aad8-44042fce248e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92fdd0>]}
[0m21:20:47.755062 [warn ] [MainThread]: The selection criterion 'silver' does not match any enabled nodes
[0m21:20:47.755594 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:20:47.755843 [debug] [MainThread]: Command end result
[0m21:20:47.765784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/manifest.json
[0m21:20:47.766647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/semantic_manifest.json
[0m21:20:47.768098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/run_results.json
[0m21:20:47.769563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0001165, "process_in_blocks": "0", "process_kernel_time": 0.244983, "process_mem_max_rss": "147341312", "process_out_blocks": "0", "process_user_time": 1.540818}
[0m21:20:47.769767 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:47.769728 after 1.00 seconds
[0m21:20:47.769959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0afa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ba650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a675550>]}
[0m21:20:47.770144 [debug] [MainThread]: Flushing usage events
[0m21:20:49.645992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:44.393646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b826d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c2d50>]}


============================== 21:40:44.396885 | f14aacfb-77d7-448b-8328-1e7d469c221d ==============================
[0m21:40:44.396885 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:40:44.397206 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m21:40:44.602896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b906110>]}
[0m21:40:44.638339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8b850>]}
[0m21:40:44.639828 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:40:44.693507 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:40:44.737780 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:40:44.738144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b154150>]}
[0m21:40:45.358873 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m21:40:45.359256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c176990>]}
[0m21:40:45.518374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c214750>]}
[0m21:40:45.561720 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/manifest.json
[0m21:40:45.563125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/semantic_manifest.json
[0m21:40:45.576671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8f3f90>]}
[0m21:40:45.576964 [info ] [MainThread]: Found 8 models, 56 data tests, 2 sources, 431 macros
[0m21:40:45.577154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14aacfb-77d7-448b-8328-1e7d469c221d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfb4690>]}
[0m21:40:45.578499 [info ] [MainThread]: 
[0m21:40:45.578678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:40:45.578811 [info ] [MainThread]: 
[0m21:40:45.579032 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:40:45.581530 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:40:45.581806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:40:45.587262 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:40:45.588425 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:40:45.616085 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:40:45.616323 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:40:45.616486 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:40:45.616631 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:40:45.616814 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.617011 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.617181 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.617372 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.617542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:45.617691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:45.617832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:45.617977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:45.646810 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.647097 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:40:45.648819 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.649027 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:40:45.650684 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.650878 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:40:45.652568 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:40:45.652760 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m21:40:45.653074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:45.653236 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m21:40:45.653368 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m21:40:45.653485 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m21:40:45.653597 [debug] [MainThread]: Connection 'list_medallion' was properly closed.
[0m21:40:45.653734 [info ] [MainThread]: 
[0m21:40:45.653894 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m21:40:45.654136 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/sirawich/Documents/lab_lakehouse/dbt_duckdb/medallion.duckdb": Conflicting lock is held in /Users/sirawich/.duckdb/cli/1.4.0/duckdb (PID 84660) by user sirawich. See also https://duckdb.org/docs/stable/connect/concurrency
[0m21:40:45.654428 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:40:45.655972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3048736, "process_in_blocks": "0", "process_kernel_time": 0.278991, "process_mem_max_rss": "158236672", "process_out_blocks": "0", "process_user_time": 1.835255}
[0m21:40:45.656189 [debug] [MainThread]: Command `dbt run` failed at 21:40:45.656151 after 1.31 seconds
[0m21:40:45.656378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107263f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8c2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2a9dd0>]}
[0m21:40:45.656561 [debug] [MainThread]: Flushing usage events
[0m21:40:47.134785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:17.972197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d9b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3dacd0>]}


============================== 21:41:17.975257 | f477dd84-a31c-4ea5-9114-6ccbc9a857c9 ==============================
[0m21:41:17.975257 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:41:17.975773 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'write_json': 'True', 'warn_error': 'None', 'no_print': 'None'}
[0m21:41:18.065336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f477dd84-a31c-4ea5-9114-6ccbc9a857c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c2650>]}
[0m21:41:18.074964 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:18.075416 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:41:18.076855 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1468732, "process_in_blocks": "0", "process_kernel_time": 0.178315, "process_mem_max_rss": "124370944", "process_out_blocks": "0", "process_user_time": 0.852206}
[0m21:41:18.077094 [debug] [MainThread]: Command `dbt deps` succeeded at 21:41:18.077035 after 0.15 seconds
[0m21:41:18.077288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c13f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a40fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a40fdd0>]}
[0m21:41:18.077467 [debug] [MainThread]: Flushing usage events
[0m21:41:19.557284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:46.585617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c765890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7d4f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7d7650>]}


============================== 21:43:46.588086 | 00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804 ==============================
[0m21:43:46.588086 [info ] [MainThread]: Running with dbt=1.10.10
[0m21:43:46.588398 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/sirawich/Documents/lab_lakehouse/medallion_project', 'log_path': '/Users/sirawich/Documents/lab_lakehouse/medallion_project/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'empty': 'False'}
[0m21:43:46.734057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c07e190>]}
[0m21:43:46.771072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ac790>]}
[0m21:43:46.772528 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m21:43:46.822577 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m21:43:46.917936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:46.918209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:46.941027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca82490>]}
[0m21:43:46.985092 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/manifest.json
[0m21:43:46.986207 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/semantic_manifest.json
[0m21:43:46.994816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9f0690>]}
[0m21:43:46.995095 [info ] [MainThread]: Found 8 models, 56 data tests, 2 sources, 431 macros
[0m21:43:46.995269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce83b10>]}
[0m21:43:46.996509 [info ] [MainThread]: 
[0m21:43:46.996679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:43:46.996804 [info ] [MainThread]: 
[0m21:43:46.997025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:43:46.999382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:43:46.999643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:43:47.005859 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:43:47.007058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m21:43:47.030336 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:43:47.030628 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:43:47.030867 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:43:47.031007 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:43:47.031187 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m21:43:47.031355 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:43:47.031530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:47.031685 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:43:47.031827 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m21:43:47.031955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:47.032173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:47.032397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:56.769603 [debug] [ThreadPool]: SQL status: OK in 9.737 seconds
[0m21:43:56.769851 [debug] [ThreadPool]: SQL status: OK in 9.738 seconds
[0m21:43:56.770024 [debug] [ThreadPool]: SQL status: OK in 9.738 seconds
[0m21:43:56.770205 [debug] [ThreadPool]: SQL status: OK in 9.738 seconds
[0m21:43:56.771339 [debug] [ThreadPool]: On list_medallion: Close
[0m21:43:56.771926 [debug] [ThreadPool]: On list_medallion: Close
[0m21:43:56.772569 [debug] [ThreadPool]: On list_medallion: Close
[0m21:43:56.773204 [debug] [ThreadPool]: On list_medallion: Close
[0m21:43:56.774018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_bronze)
[0m21:43:56.774221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_silver)
[0m21:43:56.774391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m21:43:56.774554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_gold)
[0m21:43:56.774795 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_bronze"
"
[0m21:43:56.775002 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_silver"
"
[0m21:43:56.775188 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m21:43:56.775381 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_gold"
"
[0m21:43:56.779054 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m21:43:56.780209 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m21:43:56.781100 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m21:43:56.781949 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m21:43:56.782099 [debug] [ThreadPool]: On create_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m21:43:56.782244 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m21:43:56.782384 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m21:43:56.782520 [debug] [ThreadPool]: On create_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m21:43:56.782649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.782780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.782897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.783016 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.783993 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:56.784211 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:56.784827 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m21:43:56.784989 [debug] [ThreadPool]: On create_medallion_main_bronze: BEGIN
[0m21:43:56.785128 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:43:56.785672 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m21:43:56.785913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.786058 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:43:56.786544 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m21:43:56.786665 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m21:43:56.786803 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m21:43:56.787351 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m21:43:56.787473 [debug] [ThreadPool]: On create_medallion_main_silver: BEGIN
[0m21:43:56.787654 [debug] [ThreadPool]: On create_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_bronze"} */

    
    
        create schema if not exists "medallion"."main_bronze"
    
[0m21:43:56.787790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.787908 [debug] [ThreadPool]: On create_medallion_main_gold: BEGIN
[0m21:43:56.788349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.788472 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m21:43:56.788609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:56.788755 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m21:43:56.788883 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.789013 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m21:43:56.789376 [debug] [ThreadPool]: On create_medallion_main_bronze: COMMIT
[0m21:43:56.789534 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
    
        create schema if not exists "medallion"."main_silver"
    
[0m21:43:56.789684 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m21:43:56.789868 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m21:43:56.790009 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.790176 [debug] [ThreadPool]: On create_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_gold"} */

    
    
        create schema if not exists "medallion"."main_gold"
    
[0m21:43:56.790311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.790430 [debug] [ThreadPool]: On create_medallion_main_bronze: COMMIT
[0m21:43:56.790800 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m21:43:56.791183 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m21:43:56.791323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.791491 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m21:43:56.791648 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m21:43:56.791780 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.792122 [debug] [ThreadPool]: On create_medallion_main_gold: COMMIT
[0m21:43:56.792259 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m21:43:56.792391 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m21:43:56.792536 [debug] [ThreadPool]: On create_medallion_main_bronze: Close
[0m21:43:56.792666 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m21:43:56.792913 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.793054 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.793301 [debug] [ThreadPool]: On create_medallion_main_gold: COMMIT
[0m21:43:56.793439 [debug] [ThreadPool]: On create_medallion_main: Close
[0m21:43:56.793579 [debug] [ThreadPool]: On create_medallion_main_silver: Close
[0m21:43:56.793896 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:43:56.794125 [debug] [ThreadPool]: On create_medallion_main_gold: Close
[0m21:43:56.794904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_silver, now list_medallion_main_bronze)
[0m21:43:56.795116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_bronze, now list_medallion_main_silver)
[0m21:43:56.795330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main)
[0m21:43:56.795529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_gold, now list_medallion_main_gold)
[0m21:43:56.798711 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m21:43:56.799641 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m21:43:56.800520 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m21:43:56.801411 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m21:43:56.801599 [debug] [ThreadPool]: On list_medallion_main_bronze: BEGIN
[0m21:43:56.801756 [debug] [ThreadPool]: On list_medallion_main_silver: BEGIN
[0m21:43:56.801902 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m21:43:56.802038 [debug] [ThreadPool]: On list_medallion_main_gold: BEGIN
[0m21:43:56.802172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.802317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.802470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.802605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:56.803106 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:43:56.803339 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m21:43:56.803566 [debug] [ThreadPool]: On list_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_bronze"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'medallion'
  
[0m21:43:56.803839 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:43:56.804048 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m21:43:56.804181 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:43:56.804361 [debug] [ThreadPool]: On list_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'medallion'
  
[0m21:43:56.804608 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m21:43:56.804783 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:43:56.805027 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m21:43:56.805198 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m21:43:56.805475 [debug] [ThreadPool]: On list_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_gold"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'medallion'
  
[0m21:43:56.812538 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:43:56.812739 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:43:56.812885 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:43:56.813015 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:43:56.813675 [debug] [ThreadPool]: On list_medallion_main_silver: ROLLBACK
[0m21:43:56.814194 [debug] [ThreadPool]: On list_medallion_main_bronze: ROLLBACK
[0m21:43:56.814679 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m21:43:56.815136 [debug] [ThreadPool]: On list_medallion_main_gold: ROLLBACK
[0m21:43:56.815953 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_gold'
[0m21:43:56.816146 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_silver'
[0m21:43:56.816327 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_bronze'
[0m21:43:56.816522 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m21:43:56.816668 [debug] [ThreadPool]: On list_medallion_main_gold: Close
[0m21:43:56.816819 [debug] [ThreadPool]: On list_medallion_main_silver: Close
[0m21:43:56.816972 [debug] [ThreadPool]: On list_medallion_main_bronze: Close
[0m21:43:56.817111 [debug] [ThreadPool]: On list_medallion_main: Close
[0m21:43:56.817710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbfa510>]}
[0m21:43:56.817970 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:56.818109 [debug] [MainThread]: On master: BEGIN
[0m21:43:56.818238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:56.818705 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:56.818914 [debug] [MainThread]: On master: COMMIT
[0m21:43:56.819062 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:56.819195 [debug] [MainThread]: On master: COMMIT
[0m21:43:56.819407 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:56.819589 [debug] [MainThread]: On master: Close
[0m21:43:56.821299 [debug] [Thread-1 (]: Began running node model.medallion_project.bronze_customers
[0m21:43:56.821483 [debug] [Thread-2 (]: Began running node model.medallion_project.bronze_orders
[0m21:43:56.821649 [debug] [Thread-3 (]: Began running node model.medallion_project.my_first_dbt_model
[0m21:43:56.821911 [info ] [Thread-1 (]: 1 of 8 START sql view model main_bronze.bronze_customers ....................... [RUN]
[0m21:43:56.822168 [info ] [Thread-2 (]: 2 of 8 START sql view model main_bronze.bronze_orders .......................... [RUN]
[0m21:43:56.822407 [info ] [Thread-3 (]: 3 of 8 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m21:43:56.822640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main_bronze, now model.medallion_project.bronze_customers)
[0m21:43:56.822825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_medallion_main_silver, now model.medallion_project.bronze_orders)
[0m21:43:56.823008 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_project.my_first_dbt_model)
[0m21:43:56.823183 [debug] [Thread-1 (]: Began compiling node model.medallion_project.bronze_customers
[0m21:43:56.823351 [debug] [Thread-2 (]: Began compiling node model.medallion_project.bronze_orders
[0m21:43:56.823513 [debug] [Thread-3 (]: Began compiling node model.medallion_project.my_first_dbt_model
[0m21:43:56.827928 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.bronze_customers"
[0m21:43:56.829537 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_project.bronze_orders"
[0m21:43:56.830831 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.my_first_dbt_model"
[0m21:43:56.831791 [debug] [Thread-1 (]: Began executing node model.medallion_project.bronze_customers
[0m21:43:56.832016 [debug] [Thread-3 (]: Began executing node model.medallion_project.my_first_dbt_model
[0m21:43:56.832238 [debug] [Thread-2 (]: Began executing node model.medallion_project.bronze_orders
[0m21:43:56.853814 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.bronze_customers"
[0m21:43:56.856329 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_project.bronze_orders"
[0m21:43:56.859160 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.my_first_dbt_model"
[0m21:43:56.859993 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m21:43:56.860210 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: BEGIN
[0m21:43:56.860396 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m21:43:56.860653 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m21:43:56.860884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:43:56.861114 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: BEGIN
[0m21:43:56.861333 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: BEGIN
[0m21:43:56.861634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:56.861813 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:56.862206 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.862470 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m21:43:56.862740 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */

  
  create view "medallion"."main_bronze"."bronze_orders__dbt_tmp" as (
    

-- Bronze layer: Raw order data as-is from source
-- This layer provides a 1:1 view of source data without transformation

select
    order_id,
    customer_id,
    order_date,
    amount,
    status,
    created_at,
    updated_at
from "medallion"."bronze"."raw_orders"
  );

[0m21:43:56.862980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.863341 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m21:43:56.863564 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.863740 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:43:56.863903 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */

  
  create view "medallion"."main_bronze"."bronze_customers__dbt_tmp" as (
    

-- Bronze layer: Raw customer data as-is from source
-- This layer provides a 1:1 view of source data without transformation

select
    customer_id,
    email,
    first_name,
    last_name,
    created_at,
    updated_at
from "medallion"."bronze"."raw_customers"
  );

[0m21:43:56.867099 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m21:43:56.867315 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m21:43:56.867596 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */
alter view "medallion"."main_bronze"."bronze_orders__dbt_tmp" rename to "bronze_orders"
[0m21:43:56.867794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.867984 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */

  
    
    

    create  table
      "medallion"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m21:43:56.869553 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m21:43:56.869720 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:43:56.869966 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */
alter view "medallion"."main_bronze"."bronze_customers__dbt_tmp" rename to "bronze_customers"
[0m21:43:56.874481 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: COMMIT
[0m21:43:56.874738 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:43:56.874926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.875098 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m21:43:56.876555 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m21:43:56.877230 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: COMMIT
[0m21:43:56.877413 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: COMMIT
[0m21:43:56.877613 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */
alter table "medallion"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:43:56.877785 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m21:43:56.878129 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: COMMIT
[0m21:43:56.878397 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.878588 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.881259 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m21:43:56.881433 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:43:56.883699 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: COMMIT
[0m21:43:56.883900 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */

      drop view if exists "medallion"."main_bronze"."bronze_orders__dbt_backup" cascade
    
[0m21:43:56.884990 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m21:43:56.885164 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m21:43:56.885403 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */

      drop view if exists "medallion"."main_bronze"."bronze_customers__dbt_backup" cascade
    
[0m21:43:56.885576 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.885724 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: COMMIT
[0m21:43:56.886903 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: Close
[0m21:43:56.887119 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.888430 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: Close
[0m21:43:56.888738 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:43:56.889930 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m21:43:56.890118 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */

      drop table if exists "medallion"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m21:43:56.890401 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.890589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c1e50>]}
[0m21:43:56.890740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3a7a50>]}
[0m21:43:56.891280 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: Close
[0m21:43:56.891613 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main_bronze.bronze_orders ..................... [[32mOK[0m in 0.06s]
[0m21:43:56.891909 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_bronze.bronze_customers .................. [[32mOK[0m in 0.07s]
[0m21:43:56.892161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d09da10>]}
[0m21:43:56.892407 [debug] [Thread-2 (]: Finished running node model.medallion_project.bronze_orders
[0m21:43:56.892634 [debug] [Thread-1 (]: Finished running node model.medallion_project.bronze_customers
[0m21:43:56.892886 [info ] [Thread-3 (]: 3 of 8 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m21:43:56.893247 [debug] [Thread-4 (]: Began running node model.medallion_project.silver_customers
[0m21:43:56.893457 [debug] [Thread-3 (]: Finished running node model.medallion_project.my_first_dbt_model
[0m21:43:56.893678 [info ] [Thread-4 (]: 4 of 8 START sql table model main_silver.silver_customers ...................... [RUN]
[0m21:43:56.893958 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_medallion_main_gold, now model.medallion_project.silver_customers)
[0m21:43:56.894127 [debug] [Thread-1 (]: Began running node model.medallion_project.my_second_dbt_model
[0m21:43:56.894285 [debug] [Thread-4 (]: Began compiling node model.medallion_project.silver_customers
[0m21:43:56.894492 [info ] [Thread-1 (]: 5 of 8 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m21:43:56.896076 [debug] [Thread-4 (]: Writing injected SQL for node "model.medallion_project.silver_customers"
[0m21:43:56.896283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medallion_project.bronze_customers, now model.medallion_project.my_second_dbt_model)
[0m21:43:56.896493 [debug] [Thread-1 (]: Began compiling node model.medallion_project.my_second_dbt_model
[0m21:43:56.897696 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.my_second_dbt_model"
[0m21:43:56.898071 [debug] [Thread-4 (]: Began executing node model.medallion_project.silver_customers
[0m21:43:56.898229 [debug] [Thread-1 (]: Began executing node model.medallion_project.my_second_dbt_model
[0m21:43:56.899757 [debug] [Thread-4 (]: Writing runtime sql for node "model.medallion_project.silver_customers"
[0m21:43:56.902354 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.my_second_dbt_model"
[0m21:43:56.902758 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m21:43:56.902945 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m21:43:56.903095 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: BEGIN
[0m21:43:56.903263 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: BEGIN
[0m21:43:56.903424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:56.903580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:56.904033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.904203 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m21:43:56.904369 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */

  
  create view "medallion"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "medallion"."main"."my_first_dbt_model"
where id = 1
  );

[0m21:43:56.904522 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.904734 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m21:43:56.904886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.905062 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

  
    
    

    create  table
      "medallion"."main_silver"."silver_customers__dbt_tmp"
  
    as (
      

-- Silver layer: Cleaned and standardized customer data
-- This layer applies data quality rules and standardization

with source as (
    select * from "medallion"."main_bronze"."bronze_customers"
),

cleaned as (
    select
        customer_id,
        lower(trim(email)) as email,
        trim(first_name) as first_name,
        trim(last_name) as last_name,
        first_name || ' ' || last_name as full_name,
        created_at,
        updated_at,
        current_timestamp as dbt_loaded_at
    from source
    where
        -- Data quality filters
        customer_id is not null
        and email is not null
        and email like '%@%.%'  -- Basic email validation
        and first_name is not null
        and last_name is not null
)

select * from cleaned
    );
  
  
[0m21:43:56.906602 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m21:43:56.906960 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */
alter view "medallion"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:43:56.907344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.908002 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: COMMIT
[0m21:43:56.908188 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m21:43:56.908402 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: COMMIT
[0m21:43:56.908968 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.910250 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m21:43:56.910458 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */

      drop view if exists "medallion"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m21:43:56.910694 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:43:56.910892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.912325 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m21:43:56.912876 [debug] [Thread-1 (]: On model.medallion_project.my_second_dbt_model: Close
[0m21:43:56.913107 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */
alter table "medallion"."main_silver"."silver_customers__dbt_tmp" rename to "silver_customers"
[0m21:43:56.913455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b925390>]}
[0m21:43:56.913840 [info ] [Thread-1 (]: 5 of 8 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m21:43:56.914035 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.914285 [debug] [Thread-1 (]: Finished running node model.medallion_project.my_second_dbt_model
[0m21:43:56.914985 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: COMMIT
[0m21:43:56.915227 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m21:43:56.915394 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: COMMIT
[0m21:43:56.915917 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.917094 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m21:43:56.917285 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

      drop table if exists "medallion"."main_silver"."silver_customers__dbt_backup" cascade
    
[0m21:43:56.917585 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.918201 [debug] [Thread-4 (]: On model.medallion_project.silver_customers: Close
[0m21:43:56.918487 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d419a90>]}
[0m21:43:56.918787 [info ] [Thread-4 (]: 4 of 8 OK created sql table model main_silver.silver_customers ................. [[32mOK[0m in 0.02s]
[0m21:43:56.919041 [debug] [Thread-4 (]: Finished running node model.medallion_project.silver_customers
[0m21:43:56.919384 [debug] [Thread-3 (]: Began running node model.medallion_project.silver_orders
[0m21:43:56.919677 [info ] [Thread-3 (]: 6 of 8 START sql table model main_silver.silver_orders ......................... [RUN]
[0m21:43:56.919894 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medallion_project.my_first_dbt_model, now model.medallion_project.silver_orders)
[0m21:43:56.920062 [debug] [Thread-3 (]: Began compiling node model.medallion_project.silver_orders
[0m21:43:56.921782 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.silver_orders"
[0m21:43:56.922207 [debug] [Thread-3 (]: Began executing node model.medallion_project.silver_orders
[0m21:43:56.923692 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.silver_orders"
[0m21:43:56.924006 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m21:43:56.924164 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: BEGIN
[0m21:43:56.924314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:43:56.924742 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.924906 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m21:43:56.925084 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

  
    
    

    create  table
      "medallion"."main_silver"."silver_orders__dbt_tmp"
  
    as (
      

-- Silver layer: Cleaned and standardized order data
-- This layer applies data quality rules and enriches with customer information

with source as (
    select * from "medallion"."main_bronze"."bronze_orders"
),

customers as (
    select customer_id from "medallion"."main_silver"."silver_customers"
),

cleaned as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        cast(o.order_date as date) as order_date_only,
        o.amount,
        upper(trim(o.status)) as status,
        o.created_at,
        o.updated_at,
        current_timestamp as dbt_loaded_at
    from source o
    inner join customers c
        on o.customer_id = c.customer_id
    where
        -- Data quality filters
        o.order_id is not null
        and o.customer_id is not null
        and o.order_date is not null
        and o.amount is not null
        and o.amount > 0
        and o.status is not null
)

select * from cleaned
    );
  
  
[0m21:43:56.929373 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:43:56.930910 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m21:43:56.931101 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */
alter table "medallion"."main_silver"."silver_orders__dbt_tmp" rename to "silver_orders"
[0m21:43:56.931397 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.932128 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: COMMIT
[0m21:43:56.932294 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m21:43:56.932450 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: COMMIT
[0m21:43:56.933608 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.934670 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m21:43:56.934829 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

      drop table if exists "medallion"."main_silver"."silver_orders__dbt_backup" cascade
    
[0m21:43:56.935071 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.935608 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: Close
[0m21:43:56.935844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3e2750>]}
[0m21:43:56.936112 [info ] [Thread-3 (]: 6 of 8 OK created sql table model main_silver.silver_orders .................... [[32mOK[0m in 0.02s]
[0m21:43:56.936337 [debug] [Thread-3 (]: Finished running node model.medallion_project.silver_orders
[0m21:43:56.936681 [debug] [Thread-1 (]: Began running node model.medallion_project.gold_customer_metrics
[0m21:43:56.936890 [debug] [Thread-4 (]: Began running node model.medallion_project.gold_daily_sales
[0m21:43:56.937096 [info ] [Thread-1 (]: 7 of 8 START sql table model main_gold.gold_customer_metrics ................... [RUN]
[0m21:43:56.937326 [info ] [Thread-4 (]: 8 of 8 START sql table model main_gold.gold_daily_sales ........................ [RUN]
[0m21:43:56.937537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medallion_project.my_second_dbt_model, now model.medallion_project.gold_customer_metrics)
[0m21:43:56.937722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medallion_project.silver_customers, now model.medallion_project.gold_daily_sales)
[0m21:43:56.937884 [debug] [Thread-1 (]: Began compiling node model.medallion_project.gold_customer_metrics
[0m21:43:56.938099 [debug] [Thread-4 (]: Began compiling node model.medallion_project.gold_daily_sales
[0m21:43:56.939975 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.gold_customer_metrics"
[0m21:43:56.941695 [debug] [Thread-4 (]: Writing injected SQL for node "model.medallion_project.gold_daily_sales"
[0m21:43:56.942430 [debug] [Thread-1 (]: Began executing node model.medallion_project.gold_customer_metrics
[0m21:43:56.942609 [debug] [Thread-4 (]: Began executing node model.medallion_project.gold_daily_sales
[0m21:43:56.945645 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.gold_customer_metrics"
[0m21:43:56.947150 [debug] [Thread-4 (]: Writing runtime sql for node "model.medallion_project.gold_daily_sales"
[0m21:43:56.947664 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m21:43:56.947910 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m21:43:56.948111 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: BEGIN
[0m21:43:56.948327 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: BEGIN
[0m21:43:56.948546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:56.948744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:43:56.949344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.949573 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m21:43:56.949739 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.949995 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */

  
    
    

    create  table
      "medallion"."main_gold"."gold_customer_metrics__dbt_tmp"
  
    as (
      

-- Gold layer: Customer-level business metrics
-- This layer aggregates data for business intelligence and reporting

with customers as (
    select * from "medallion"."main_silver"."silver_customers"
),

orders as (
    select * from "medallion"."main_silver"."silver_orders"
),

customer_orders as (
    select
        customer_id,
        count(*) as total_orders,
        count(case when status = 'DELIVERED' then 1 end) as delivered_orders,
        count(case when status = 'CANCELLED' then 1 end) as cancelled_orders,
        sum(amount) as lifetime_value,
        avg(amount) as avg_order_value,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        max(order_date_only) as last_order_date_only
    from orders
    group by customer_id
),

metrics as (
    select
        c.customer_id,
        c.email,
        c.full_name,
        c.created_at as customer_since,
        coalesce(co.total_orders, 0) as total_orders,
        coalesce(co.delivered_orders, 0) as delivered_orders,
        coalesce(co.cancelled_orders, 0) as cancelled_orders,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        coalesce(co.avg_order_value, 0) as avg_order_value,
        co.first_order_date,
        co.last_order_date,
        co.last_order_date_only,
        case
            when co.total_orders is null then 'Never Ordered'
            when co.total_orders = 1 then 'One-Time Customer'
            when co.total_orders between 2 and 5 then 'Repeat Customer'
            when co.total_orders > 5 then 'VIP Customer'
        end as customer_segment,
        case
            when co.last_order_date_only >= current_date - interval '30 days' then 'Active'
            when co.last_order_date_only >= current_date - interval '90 days' then 'At Risk'
            when co.last_order_date_only < current_date - interval '90 days' then 'Churned'
            else 'Never Ordered'
        end as customer_status,
        current_timestamp as dbt_loaded_at
    from customers c
    left join customer_orders co
        on c.customer_id = co.customer_id
)

select * from metrics
    );
  
  
[0m21:43:56.950297 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m21:43:56.950769 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */

  
    
    

    create  table
      "medallion"."main_gold"."gold_daily_sales__dbt_tmp"
  
    as (
      

-- Gold layer: Daily sales metrics
-- This layer provides time-series metrics for business reporting and analysis

with orders as (
    select * from "medallion"."main_silver"."silver_orders"
),

daily_aggregates as (
    select
        order_date_only as sales_date,
        count(*) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(amount) as total_revenue,
        avg(amount) as avg_order_value,
        min(amount) as min_order_value,
        max(amount) as max_order_value,

        -- Orders by status
        count(case when status = 'PENDING' then 1 end) as pending_orders,
        count(case when status = 'PROCESSING' then 1 end) as processing_orders,
        count(case when status = 'SHIPPED' then 1 end) as shipped_orders,
        count(case when status = 'DELIVERED' then 1 end) as delivered_orders,
        count(case when status = 'CANCELLED' then 1 end) as cancelled_orders,

        -- Revenue by status
        sum(case when status = 'DELIVERED' then amount else 0 end) as delivered_revenue,
        sum(case when status = 'CANCELLED' then amount else 0 end) as cancelled_revenue

    from orders
    group by order_date_only
),

with_moving_averages as (
    select
        *,
        -- 7-day moving average
        avg(total_revenue) over (
            order by sales_date
            rows between 6 preceding and current row
        ) as revenue_7day_ma,

        -- 30-day moving average
        avg(total_revenue) over (
            order by sales_date
            rows between 29 preceding and current row
        ) as revenue_30day_ma,

        -- Day of week metrics
        dayname(sales_date) as day_of_week,
        extract(dow from sales_date) as day_of_week_num,

        current_timestamp as dbt_loaded_at

    from daily_aggregates
)

select * from with_moving_averages
order by sales_date desc
    );
  
  
[0m21:43:56.955366 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:43:56.957271 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m21:43:56.957499 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */
alter table "medallion"."main_gold"."gold_customer_metrics__dbt_tmp" rename to "gold_customer_metrics"
[0m21:43:56.957869 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.958660 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: COMMIT
[0m21:43:56.958852 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m21:43:56.959040 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m21:43:56.959277 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: COMMIT
[0m21:43:56.960890 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m21:43:56.961209 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */
alter table "medallion"."main_gold"."gold_daily_sales__dbt_tmp" rename to "gold_daily_sales"
[0m21:43:56.961659 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.961900 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.962717 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: COMMIT
[0m21:43:56.964018 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m21:43:56.964210 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m21:43:56.964410 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */

      drop table if exists "medallion"."main_gold"."gold_customer_metrics__dbt_backup" cascade
    
[0m21:43:56.964603 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: COMMIT
[0m21:43:56.964926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.965552 [debug] [Thread-1 (]: On model.medallion_project.gold_customer_metrics: Close
[0m21:43:56.965726 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:43:56.967003 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m21:43:56.967197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8f490>]}
[0m21:43:56.967389 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */

      drop table if exists "medallion"."main_gold"."gold_daily_sales__dbt_backup" cascade
    
[0m21:43:56.967744 [info ] [Thread-1 (]: 7 of 8 OK created sql table model main_gold.gold_customer_metrics .............. [[32mOK[0m in 0.03s]
[0m21:43:56.968108 [debug] [Thread-1 (]: Finished running node model.medallion_project.gold_customer_metrics
[0m21:43:56.968320 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:43:56.969005 [debug] [Thread-4 (]: On model.medallion_project.gold_daily_sales: Close
[0m21:43:56.969247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00e11df1-2a7e-4dfe-ad50-5cdfcb6d1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d434790>]}
[0m21:43:56.969529 [info ] [Thread-4 (]: 8 of 8 OK created sql table model main_gold.gold_daily_sales ................... [[32mOK[0m in 0.03s]
[0m21:43:56.969773 [debug] [Thread-4 (]: Finished running node model.medallion_project.gold_daily_sales
[0m21:43:56.970389 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:56.970542 [debug] [MainThread]: On master: BEGIN
[0m21:43:56.970667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:56.970995 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:56.971126 [debug] [MainThread]: On master: COMMIT
[0m21:43:56.971253 [debug] [MainThread]: Using duckdb connection "master"
[0m21:43:56.971375 [debug] [MainThread]: On master: COMMIT
[0m21:43:56.971525 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:43:56.971653 [debug] [MainThread]: On master: Close
[0m21:43:56.971812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:56.971933 [debug] [MainThread]: Connection 'model.medallion_project.gold_customer_metrics' was properly closed.
[0m21:43:56.972043 [debug] [MainThread]: Connection 'model.medallion_project.bronze_orders' was properly closed.
[0m21:43:56.972151 [debug] [MainThread]: Connection 'model.medallion_project.silver_orders' was properly closed.
[0m21:43:56.972254 [debug] [MainThread]: Connection 'model.medallion_project.gold_daily_sales' was properly closed.
[0m21:43:56.972433 [info ] [MainThread]: 
[0m21:43:56.972577 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m21:43:56.973189 [debug] [MainThread]: Command end result
[0m21:43:56.989527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/manifest.json
[0m21:43:56.990533 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/semantic_manifest.json
[0m21:43:56.993478 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/sirawich/Documents/lab_lakehouse/medallion_project/target/run_results.json
[0m21:43:56.993638 [info ] [MainThread]: 
[0m21:43:56.993824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:43:56.993965 [info ] [MainThread]: 
[0m21:43:56.994115 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m21:43:56.995558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.449691, "process_in_blocks": "0", "process_kernel_time": 0.540437, "process_mem_max_rss": "271810560", "process_out_blocks": "0", "process_user_time": 1.60543}
[0m21:43:56.995776 [debug] [MainThread]: Command `dbt run` succeeded at 21:43:56.995739 after 10.45 seconds
[0m21:43:57.000854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108033f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7f7650>]}
[0m21:43:57.001151 [debug] [MainThread]: Flushing usage events
[0m21:43:58.673329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:11.624450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b62f8f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b62b31700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b62f8d4c0>]}


============================== 14:54:12.104284 | 2f993fbb-5f0c-4bcb-819e-a94b859eb328 ==============================
[0m14:54:12.104284 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:54:12.105474 [debug] [MainThread]: running dbt with arguments {'log_path': '/content/drive/MyDrive/dbt_project/medallion_project/logs', 'partial_parse': 'True', 'profiles_dir': '/content/drive/MyDrive/dbt_project/medallion_project', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None'}
[0m14:54:12.175380 [info ] [MainThread]: dbt version: 1.10.13
[0m14:54:12.176338 [info ] [MainThread]: python version: 3.12.12
[0m14:54:12.177119 [info ] [MainThread]: python path: /usr/bin/python3
[0m14:54:12.177993 [info ] [MainThread]: os info: Linux-6.6.105+-x86_64-with-glibc2.35
[0m14:54:12.434837 [info ] [MainThread]: Using profiles dir at /content/drive/MyDrive/dbt_project/medallion_project
[0m14:54:12.437114 [info ] [MainThread]: Using profiles.yml file at /content/drive/MyDrive/dbt_project/medallion_project/profiles.yml
[0m14:54:12.438335 [info ] [MainThread]: Using dbt_project.yml file at /content/drive/MyDrive/dbt_project/medallion_project/dbt_project.yml
[0m14:54:12.441350 [info ] [MainThread]: adapter type: duckdb
[0m14:54:12.442601 [info ] [MainThread]: adapter version: 1.9.6
[0m14:54:12.743101 [info ] [MainThread]: Configuration:
[0m14:54:12.744318 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:54:12.745286 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:54:12.746218 [info ] [MainThread]: Required dependencies:
[0m14:54:12.747350 [debug] [MainThread]: Executing "git --help"
[0m14:54:12.782606 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:54:12.784108 [debug] [MainThread]: STDERR: "b''"
[0m14:54:12.785198 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:54:12.786228 [info ] [MainThread]: Connection:
[0m14:54:12.787179 [info ] [MainThread]:   database: medallion
[0m14:54:12.788068 [info ] [MainThread]:   schema: main
[0m14:54:12.788946 [info ] [MainThread]:   path: /content/drive/MyDrive/dbt_project/dbt_duckdb/medallion.duckdb
[0m14:54:12.789815 [info ] [MainThread]:   config_options: None
[0m14:54:12.790952 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 'json']
[0m14:54:12.792152 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'temp_directory': '/tmp/duckdb_temp'}
[0m14:54:12.793146 [info ] [MainThread]:   external_root: .
[0m14:54:12.794122 [info ] [MainThread]:   use_credential_provider: None
[0m14:54:12.795202 [info ] [MainThread]:   attach: None
[0m14:54:12.796170 [info ] [MainThread]:   filesystems: None
[0m14:54:12.797097 [info ] [MainThread]:   remote: None
[0m14:54:12.798654 [info ] [MainThread]:   plugins: None
[0m14:54:12.800370 [info ] [MainThread]:   disable_transactions: False
[0m14:54:12.801835 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:54:13.063563 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:54:13.154709 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:54:13.155834 [debug] [MainThread]: On debug: select 1 as id
[0m14:54:13.156732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:16.684741 [debug] [MainThread]: SQL status: OK in 3.528 seconds
[0m14:54:16.686588 [debug] [MainThread]: On debug: Close
[0m14:54:16.687627 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:54:16.688449 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:54:16.690274 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.7733016, "process_in_blocks": "40008", "process_kernel_time": 0.791065, "process_mem_max_rss": "287356", "process_out_blocks": "272736", "process_user_time": 6.011102}
[0m14:54:16.691248 [debug] [MainThread]: Command `dbt debug` succeeded at 14:54:16.691090 after 6.77 seconds
[0m14:54:16.692011 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:54:16.692798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b635b0e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b5e70dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6b62f8d4c0>]}
[0m14:54:16.693594 [debug] [MainThread]: Flushing usage events
[0m14:54:16.972065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:00.636982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83595acf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8358e125a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e835884f8f0>]}


============================== 14:55:00.643532 | 4f0b172d-1259-41ba-ac2e-756899e98a91 ==============================
[0m14:55:00.643532 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:55:00.644685 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/content/drive/MyDrive/dbt_project/medallion_project/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'profiles_dir': '/content/drive/MyDrive/dbt_project/medallion_project', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m14:55:01.257995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e835ae70e90>]}
[0m14:55:01.377775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83598211f0>]}
[0m14:55:01.380534 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m14:55:01.521577 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:55:02.190104 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:55:02.191130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8358a79f70>]}
[0m14:55:10.466805 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:55:10.467964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83541c86e0>]}
[0m14:55:10.870579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83539ec9b0>]}
[0m14:55:11.520683 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m14:55:12.034047 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m14:55:12.963487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83541ae900>]}
[0m14:55:12.964876 [info ] [MainThread]: Found 8 models, 56 data tests, 2 sources, 444 macros
[0m14:55:12.966382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8353fee8a0>]}
[0m14:55:12.971202 [info ] [MainThread]: 
[0m14:55:12.972249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:12.973038 [info ] [MainThread]: 
[0m14:55:12.974040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:12.980872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m14:55:12.987172 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m14:55:13.000316 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m14:55:13.007451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m14:55:13.040607 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m14:55:13.041443 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m14:55:13.042077 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m14:55:13.042653 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m14:55:13.043248 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m14:55:13.044106 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m14:55:13.044999 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m14:55:13.046046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.046871 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m14:55:13.047595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.048317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.049301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.389869 [debug] [ThreadPool]: SQL status: OK in 0.342 seconds
[0m14:55:13.390827 [debug] [ThreadPool]: SQL status: OK in 0.342 seconds
[0m14:55:13.391478 [debug] [ThreadPool]: SQL status: OK in 0.342 seconds
[0m14:55:13.392161 [debug] [ThreadPool]: SQL status: OK in 0.346 seconds
[0m14:55:13.393932 [debug] [ThreadPool]: On list_medallion: Close
[0m14:55:13.396039 [debug] [ThreadPool]: On list_medallion: Close
[0m14:55:13.397787 [debug] [ThreadPool]: On list_medallion: Close
[0m14:55:13.399535 [debug] [ThreadPool]: On list_medallion: Close
[0m14:55:13.402052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_bronze)
[0m14:55:13.404242 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_bronze"
"
[0m14:55:13.403505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_silver)
[0m14:55:13.402839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main)
[0m14:55:13.404904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_gold)
[0m14:55:13.414037 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m14:55:13.414969 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_silver"
"
[0m14:55:13.416024 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main"
"
[0m14:55:13.417067 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_gold"
"
[0m14:55:13.417863 [debug] [ThreadPool]: On create_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m14:55:13.421026 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m14:55:13.424201 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m14:55:13.427275 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m14:55:13.428360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.429319 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m14:55:13.430293 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m14:55:13.433726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.432832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.431433 [debug] [ThreadPool]: On create_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m14:55:13.435743 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:55:13.436642 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:13.437975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.440798 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m14:55:13.441548 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:55:13.443591 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m14:55:13.448006 [debug] [ThreadPool]: On create_medallion_main: BEGIN
[0m14:55:13.447118 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m14:55:13.444888 [debug] [ThreadPool]: On create_medallion_main_bronze: BEGIN
[0m14:55:13.448848 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m14:55:13.449729 [debug] [ThreadPool]: On create_medallion_main_silver: BEGIN
[0m14:55:13.450576 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.451271 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.453830 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m14:55:13.454583 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:55:13.455214 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m14:55:13.455968 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m14:55:13.456711 [debug] [ThreadPool]: On create_medallion_main_gold: BEGIN
[0m14:55:13.457827 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m14:55:13.458595 [debug] [ThreadPool]: On create_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main"} */

    
    
        create schema if not exists "medallion"."main"
    
[0m14:55:13.459464 [debug] [ThreadPool]: On create_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_bronze"} */

    
    
        create schema if not exists "medallion"."main_bronze"
    
[0m14:55:13.460812 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
    
        create schema if not exists "medallion"."main_silver"
    
[0m14:55:13.464001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.462701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:13.461640 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.464583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.466015 [debug] [ThreadPool]: On create_medallion_main_bronze: COMMIT
[0m14:55:13.467574 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m14:55:13.468357 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m14:55:13.469987 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m14:55:13.471213 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_bronze"
[0m14:55:13.472011 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main"
[0m14:55:13.472744 [debug] [ThreadPool]: On create_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_gold"} */

    
    
        create schema if not exists "medallion"."main_gold"
    
[0m14:55:13.473711 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m14:55:13.474578 [debug] [ThreadPool]: On create_medallion_main_bronze: COMMIT
[0m14:55:13.475312 [debug] [ThreadPool]: On create_medallion_main: COMMIT
[0m14:55:13.476295 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m14:55:13.477055 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.478701 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:55:13.482219 [debug] [ThreadPool]: On create_medallion_main_gold: COMMIT
[0m14:55:13.497352 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_gold"
[0m14:55:13.498452 [debug] [ThreadPool]: On create_medallion_main_gold: COMMIT
[0m14:55:13.490769 [debug] [ThreadPool]: On create_medallion_main: Close
[0m14:55:13.494897 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m14:55:13.503337 [debug] [ThreadPool]: On create_medallion_main_bronze: Close
[0m14:55:13.505340 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m14:55:13.508156 [debug] [ThreadPool]: On create_medallion_main_silver: Close
[0m14:55:13.507144 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:55:13.509727 [debug] [ThreadPool]: On create_medallion_main_gold: Close
[0m14:55:13.514485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_silver, now list_medallion_main_bronze)
[0m14:55:13.518347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_bronze, now list_medallion_main_silver)
[0m14:55:13.517492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main, now list_medallion_main_gold)
[0m14:55:13.516059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_gold, now list_medallion_main)
[0m14:55:13.530937 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m14:55:13.534244 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m14:55:13.538186 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m14:55:13.541622 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m14:55:13.542558 [debug] [ThreadPool]: On list_medallion_main_bronze: BEGIN
[0m14:55:13.543361 [debug] [ThreadPool]: On list_medallion_main_silver: BEGIN
[0m14:55:13.546501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.544862 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m14:55:13.547604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.544145 [debug] [ThreadPool]: On list_medallion_main_gold: BEGIN
[0m14:55:13.545637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.548594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:13.549845 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:55:13.550932 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m14:55:13.551783 [debug] [ThreadPool]: On list_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'medallion'
  
[0m14:55:13.552591 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:55:13.555319 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m14:55:13.557453 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m14:55:13.558958 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m14:55:13.561268 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m14:55:13.566312 [debug] [ThreadPool]: On list_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_bronze"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'medallion'
  
[0m14:55:13.562281 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m14:55:13.573365 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m14:55:13.578242 [debug] [ThreadPool]: On list_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_gold"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'medallion'
  
[0m14:55:13.582116 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m14:55:13.585114 [debug] [ThreadPool]: On list_medallion_main_silver: ROLLBACK
[0m14:55:13.586166 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m14:55:13.586962 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:55:13.589205 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_silver'
[0m14:55:13.590056 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:55:13.592250 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m14:55:13.594122 [debug] [ThreadPool]: On list_medallion_main_bronze: ROLLBACK
[0m14:55:13.594722 [debug] [ThreadPool]: On list_medallion_main_silver: Close
[0m14:55:13.596876 [debug] [ThreadPool]: On list_medallion_main_gold: ROLLBACK
[0m14:55:13.598633 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m14:55:13.600781 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_bronze'
[0m14:55:13.603453 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_gold'
[0m14:55:13.604116 [debug] [ThreadPool]: On list_medallion_main: Close
[0m14:55:13.604953 [debug] [ThreadPool]: On list_medallion_main_bronze: Close
[0m14:55:13.605770 [debug] [ThreadPool]: On list_medallion_main_gold: Close
[0m14:55:13.608239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8353510ec0>]}
[0m14:55:13.609252 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:13.609949 [debug] [MainThread]: On master: BEGIN
[0m14:55:13.610593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:13.612459 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:55:13.613454 [debug] [MainThread]: On master: COMMIT
[0m14:55:13.614288 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:13.615015 [debug] [MainThread]: On master: COMMIT
[0m14:55:13.616412 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:13.618995 [debug] [MainThread]: On master: Close
[0m14:55:13.623418 [debug] [Thread-1 (]: Began running node model.medallion_project.bronze_customers
[0m14:55:13.624179 [debug] [Thread-2 (]: Began running node model.medallion_project.bronze_orders
[0m14:55:13.624900 [debug] [Thread-3 (]: Began running node model.medallion_project.my_first_dbt_model
[0m14:55:13.625845 [info ] [Thread-1 (]: 1 of 8 START sql view model main_bronze.bronze_customers ....................... [RUN]
[0m14:55:13.626925 [info ] [Thread-2 (]: 2 of 8 START sql view model main_bronze.bronze_orders .......................... [RUN]
[0m14:55:13.627916 [info ] [Thread-3 (]: 3 of 8 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:55:13.628951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main_silver, now model.medallion_project.bronze_customers)
[0m14:55:13.629959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_medallion_main_gold, now model.medallion_project.bronze_orders)
[0m14:55:13.633447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_medallion_main_bronze, now model.medallion_project.my_first_dbt_model)
[0m14:55:13.634378 [debug] [Thread-1 (]: Began compiling node model.medallion_project.bronze_customers
[0m14:55:13.635310 [debug] [Thread-2 (]: Began compiling node model.medallion_project.bronze_orders
[0m14:55:13.636274 [debug] [Thread-3 (]: Began compiling node model.medallion_project.my_first_dbt_model
[0m14:55:13.646543 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.bronze_customers"
[0m14:55:13.651444 [debug] [Thread-2 (]: Writing injected SQL for node "model.medallion_project.bronze_orders"
[0m14:55:13.656334 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.my_first_dbt_model"
[0m14:55:14.858805 [debug] [Thread-3 (]: Began executing node model.medallion_project.my_first_dbt_model
[0m14:55:15.418041 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.my_first_dbt_model"
[0m14:55:15.859403 [debug] [Thread-2 (]: Began executing node model.medallion_project.bronze_orders
[0m14:55:15.860605 [debug] [Thread-1 (]: Began executing node model.medallion_project.bronze_customers
[0m14:55:15.924195 [debug] [Thread-2 (]: Writing runtime sql for node "model.medallion_project.bronze_orders"
[0m14:55:15.930192 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.bronze_customers"
[0m14:55:16.871390 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m14:55:17.353602 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: BEGIN
[0m14:55:17.819602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:17.824036 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:17.825610 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m14:55:17.828284 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: BEGIN
[0m14:55:17.829590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:55:17.826735 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m14:55:17.827435 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m14:55:17.831058 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: BEGIN
[0m14:55:17.832608 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:55:17.833338 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */

  
    
    

    create  table
      "medallion"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:55:17.834161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:17.834955 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m14:55:17.837798 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */

  
  create view "medallion"."main_bronze"."bronze_orders__dbt_tmp" as (
    

-- Bronze layer: Raw order data as-is from source
-- This layer provides a 1:1 view of source data without transformation

select
    order_id,
    customer_id,
    order_date,
    amount,
    status,
    created_at,
    updated_at
from "medallion"."bronze"."raw_orders"
  );

[0m14:55:17.836978 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.838443 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:17.847546 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m14:55:17.848323 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:55:17.849273 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m14:55:17.850133 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */
alter table "medallion"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:55:17.854740 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m14:55:17.857302 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */
alter view "medallion"."main_bronze"."bronze_orders__dbt_tmp" rename to "bronze_orders"
[0m14:55:17.855775 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */

  
  create view "medallion"."main_bronze"."bronze_customers__dbt_tmp" as (
    

-- Bronze layer: Raw customer data as-is from source
-- This layer provides a 1:1 view of source data without transformation

select
    customer_id,
    email,
    first_name,
    last_name,
    created_at,
    updated_at
from "medallion"."bronze"."raw_customers"
  );

[0m14:55:17.858156 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.859512 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.860306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.884989 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: COMMIT
[0m14:55:17.888364 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: COMMIT
[0m14:55:17.892891 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m14:55:17.893946 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m14:55:17.894860 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m14:55:17.895691 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */
alter view "medallion"."main_bronze"."bronze_customers__dbt_tmp" rename to "bronze_customers"
[0m14:55:17.896671 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: COMMIT
[0m14:55:17.897485 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: COMMIT
[0m14:55:17.899325 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.902419 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: COMMIT
[0m14:55:17.903305 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:55:17.904226 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:55:17.904982 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m14:55:17.913008 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.my_first_dbt_model"
[0m14:55:17.918324 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_first_dbt_model"} */

      drop table if exists "medallion"."main"."my_first_dbt_model__dbt_backup" cascade
    
[0m14:55:17.917429 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: COMMIT
[0m14:55:17.916509 [debug] [Thread-2 (]: Using duckdb connection "model.medallion_project.bronze_orders"
[0m14:55:17.920077 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.920946 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.921609 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_orders"} */

      drop view if exists "medallion"."main_bronze"."bronze_orders__dbt_backup" cascade
    
[0m14:55:17.925328 [debug] [Thread-3 (]: On model.medallion_project.my_first_dbt_model: Close
[0m14:55:17.929416 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.bronze_customers"
[0m14:55:17.931408 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:55:17.934279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83512e40e0>]}
[0m14:55:17.935214 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.bronze_customers"} */

      drop view if exists "medallion"."main_bronze"."bronze_customers__dbt_backup" cascade
    
[0m14:55:17.937574 [debug] [Thread-2 (]: On model.medallion_project.bronze_orders: Close
[0m14:55:17.940448 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83513e5fa0>]}
[0m14:55:17.938860 [info ] [Thread-3 (]: 3 of 8 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 4.30s]
[0m14:55:17.941618 [info ] [Thread-2 (]: 2 of 8 OK created sql view model main_bronze.bronze_orders ..................... [[32mOK[0m in 4.31s]
[0m14:55:17.942376 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:55:17.943409 [debug] [Thread-3 (]: Finished running node model.medallion_project.my_first_dbt_model
[0m14:55:17.944475 [debug] [Thread-2 (]: Finished running node model.medallion_project.bronze_orders
[0m14:55:17.946549 [debug] [Thread-1 (]: On model.medallion_project.bronze_customers: Close
[0m14:55:17.948103 [debug] [Thread-4 (]: Began running node model.medallion_project.my_second_dbt_model
[0m14:55:17.950191 [info ] [Thread-4 (]: 4 of 8 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:55:17.951661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8350936ff0>]}
[0m14:55:17.952566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_medallion_main, now model.medallion_project.my_second_dbt_model)
[0m14:55:17.953945 [info ] [Thread-1 (]: 1 of 8 OK created sql view model main_bronze.bronze_customers .................. [[32mOK[0m in 4.32s]
[0m14:55:17.954918 [debug] [Thread-4 (]: Began compiling node model.medallion_project.my_second_dbt_model
[0m14:55:17.955968 [debug] [Thread-1 (]: Finished running node model.medallion_project.bronze_customers
[0m14:55:17.960151 [debug] [Thread-4 (]: Writing injected SQL for node "model.medallion_project.my_second_dbt_model"
[0m14:55:17.961678 [debug] [Thread-3 (]: Began running node model.medallion_project.silver_customers
[0m14:55:17.963128 [info ] [Thread-3 (]: 5 of 8 START sql table model main_silver.silver_customers ...................... [RUN]
[0m14:55:17.964439 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medallion_project.my_first_dbt_model, now model.medallion_project.silver_customers)
[0m14:55:17.965316 [debug] [Thread-3 (]: Began compiling node model.medallion_project.silver_customers
[0m14:55:17.971039 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.silver_customers"
[0m14:55:19.039411 [debug] [Thread-4 (]: Began executing node model.medallion_project.my_second_dbt_model
[0m14:55:19.046216 [debug] [Thread-3 (]: Began executing node model.medallion_project.silver_customers
[0m14:55:19.047395 [debug] [Thread-4 (]: Writing runtime sql for node "model.medallion_project.my_second_dbt_model"
[0m14:55:19.052177 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.silver_customers"
[0m14:55:20.174479 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m14:55:20.175928 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: BEGIN
[0m14:55:20.177497 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m14:55:20.178256 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:20.179053 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: BEGIN
[0m14:55:20.180544 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:20.182195 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:55:20.183303 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:20.184177 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m14:55:20.185160 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m14:55:20.186038 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */

  
  create view "medallion"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "medallion"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:55:20.187018 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

  
    
    

    create  table
      "medallion"."main_silver"."silver_customers__dbt_tmp"
  
    as (
      

-- Silver layer: Cleaned and standardized customer data
-- This layer applies data quality rules and standardization

with source as (
    select * from "medallion"."main_bronze"."bronze_customers"
),

cleaned as (
    select
        customer_id,
        lower(trim(email)) as email,
        trim(first_name) as first_name,
        trim(last_name) as last_name,
        first_name || ' ' || last_name as full_name,
        created_at,
        updated_at,
        current_timestamp as dbt_loaded_at
    from source
    where
        -- Data quality filters
        customer_id is not null
        and email is not null
        and email like '%@%.%'  -- Basic email validation
        and first_name is not null
        and last_name is not null
)

select * from cleaned
    );
  
  
[0m14:55:20.188791 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:20.198893 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m14:55:20.203336 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */
alter view "medallion"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:55:20.205090 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m14:55:20.210180 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m14:55:20.211447 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:55:20.212363 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */
alter table "medallion"."main_silver"."silver_customers__dbt_tmp" rename to "silver_customers"
[0m14:55:20.215093 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: COMMIT
[0m14:55:20.216626 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m14:55:20.217726 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:20.218458 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: COMMIT
[0m14:55:20.221208 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: COMMIT
[0m14:55:20.222406 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m14:55:20.223389 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: COMMIT
[0m14:55:20.224268 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:20.230736 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.my_second_dbt_model"
[0m14:55:20.231780 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:55:20.232530 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.my_second_dbt_model"} */

      drop view if exists "medallion"."main"."my_second_dbt_model__dbt_backup" cascade
    
[0m14:55:20.237083 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m14:55:20.238564 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

      drop table if exists "medallion"."main_silver"."silver_customers__dbt_backup" cascade
    
[0m14:55:20.239395 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:55:20.242415 [debug] [Thread-4 (]: On model.medallion_project.my_second_dbt_model: Close
[0m14:55:20.243492 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:55:20.245664 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e835096e720>]}
[0m14:55:20.250409 [debug] [Thread-3 (]: On model.medallion_project.silver_customers: Close
[0m14:55:20.251927 [info ] [Thread-4 (]: 4 of 8 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 2.29s]
[0m14:55:20.253510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8350979130>]}
[0m14:55:20.254637 [debug] [Thread-4 (]: Finished running node model.medallion_project.my_second_dbt_model
[0m14:55:20.256356 [info ] [Thread-3 (]: 5 of 8 OK created sql table model main_silver.silver_customers ................. [[32mOK[0m in 2.29s]
[0m14:55:20.257865 [debug] [Thread-3 (]: Finished running node model.medallion_project.silver_customers
[0m14:55:20.259117 [debug] [Thread-1 (]: Began running node model.medallion_project.silver_orders
[0m14:55:20.260064 [info ] [Thread-1 (]: 6 of 8 START sql table model main_silver.silver_orders ......................... [RUN]
[0m14:55:20.260992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medallion_project.bronze_customers, now model.medallion_project.silver_orders)
[0m14:55:20.261769 [debug] [Thread-1 (]: Began compiling node model.medallion_project.silver_orders
[0m14:55:20.266523 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.silver_orders"
[0m14:55:20.819458 [debug] [Thread-1 (]: Began executing node model.medallion_project.silver_orders
[0m14:55:20.828474 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.silver_orders"
[0m14:55:21.402713 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m14:55:21.403703 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: BEGIN
[0m14:55:21.404932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:21.407243 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:55:21.408137 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m14:55:21.408995 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

  
    
    

    create  table
      "medallion"."main_silver"."silver_orders__dbt_tmp"
  
    as (
      

-- Silver layer: Cleaned and standardized order data
-- This layer applies data quality rules and enriches with customer information

with source as (
    select * from "medallion"."main_bronze"."bronze_orders"
),

customers as (
    select customer_id from "medallion"."main_silver"."silver_customers"
),

cleaned as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        cast(o.order_date as date) as order_date_only,
        o.amount,
        upper(trim(o.status)) as status,
        o.created_at,
        o.updated_at,
        current_timestamp as dbt_loaded_at
    from source o
    inner join customers c
        on o.customer_id = c.customer_id
    where
        -- Data quality filters
        o.order_id is not null
        and o.customer_id is not null
        and o.order_date is not null
        and o.amount is not null
        and o.amount > 0
        and o.status is not null
)

select * from cleaned
    );
  
  
[0m14:55:21.418422 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:55:21.423463 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m14:55:21.424474 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */
alter table "medallion"."main_silver"."silver_orders__dbt_tmp" rename to "silver_orders"
[0m14:55:21.426148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:21.429177 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: COMMIT
[0m14:55:21.430316 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m14:55:21.431333 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: COMMIT
[0m14:55:21.437467 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:55:21.441268 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m14:55:21.442273 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

      drop table if exists "medallion"."main_silver"."silver_orders__dbt_backup" cascade
    
[0m14:55:21.443717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:21.445929 [debug] [Thread-1 (]: On model.medallion_project.silver_orders: Close
[0m14:55:21.447395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83512b2660>]}
[0m14:55:21.448573 [info ] [Thread-1 (]: 6 of 8 OK created sql table model main_silver.silver_orders .................... [[32mOK[0m in 1.19s]
[0m14:55:21.449993 [debug] [Thread-1 (]: Finished running node model.medallion_project.silver_orders
[0m14:55:21.451405 [debug] [Thread-4 (]: Began running node model.medallion_project.gold_customer_metrics
[0m14:55:21.452218 [debug] [Thread-3 (]: Began running node model.medallion_project.gold_daily_sales
[0m14:55:21.453167 [info ] [Thread-4 (]: 7 of 8 START sql table model main_gold.gold_customer_metrics ................... [RUN]
[0m14:55:21.454453 [info ] [Thread-3 (]: 8 of 8 START sql table model main_gold.gold_daily_sales ........................ [RUN]
[0m14:55:21.455492 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medallion_project.my_second_dbt_model, now model.medallion_project.gold_customer_metrics)
[0m14:55:21.456436 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medallion_project.silver_customers, now model.medallion_project.gold_daily_sales)
[0m14:55:21.457568 [debug] [Thread-4 (]: Began compiling node model.medallion_project.gold_customer_metrics
[0m14:55:21.458647 [debug] [Thread-3 (]: Began compiling node model.medallion_project.gold_daily_sales
[0m14:55:21.463894 [debug] [Thread-4 (]: Writing injected SQL for node "model.medallion_project.gold_customer_metrics"
[0m14:55:21.468732 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.gold_daily_sales"
[0m14:55:22.453121 [debug] [Thread-4 (]: Began executing node model.medallion_project.gold_customer_metrics
[0m14:55:22.459824 [debug] [Thread-3 (]: Began executing node model.medallion_project.gold_daily_sales
[0m14:55:22.460724 [debug] [Thread-4 (]: Writing runtime sql for node "model.medallion_project.gold_customer_metrics"
[0m14:55:22.465303 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.gold_daily_sales"
[0m14:55:23.430565 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m14:55:23.432523 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: BEGIN
[0m14:55:23.434317 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m14:55:23.435392 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:55:23.436718 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: BEGIN
[0m14:55:23.438066 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:55:23.439656 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:55:23.440472 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m14:55:23.441363 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */

  
    
    

    create  table
      "medallion"."main_gold"."gold_customer_metrics__dbt_tmp"
  
    as (
      

-- Gold layer: Customer-level business metrics
-- This layer aggregates data for business intelligence and reporting

with customers as (
    select * from "medallion"."main_silver"."silver_customers"
),

orders as (
    select * from "medallion"."main_silver"."silver_orders"
),

customer_orders as (
    select
        customer_id,
        count(*) as total_orders,
        count(case when status = 'DELIVERED' then 1 end) as delivered_orders,
        count(case when status = 'CANCELLED' then 1 end) as cancelled_orders,
        sum(amount) as lifetime_value,
        avg(amount) as avg_order_value,
        min(order_date) as first_order_date,
        max(order_date) as last_order_date,
        max(order_date_only) as last_order_date_only
    from orders
    group by customer_id
),

metrics as (
    select
        c.customer_id,
        c.email,
        c.full_name,
        c.created_at as customer_since,
        coalesce(co.total_orders, 0) as total_orders,
        coalesce(co.delivered_orders, 0) as delivered_orders,
        coalesce(co.cancelled_orders, 0) as cancelled_orders,
        coalesce(co.lifetime_value, 0) as lifetime_value,
        coalesce(co.avg_order_value, 0) as avg_order_value,
        co.first_order_date,
        co.last_order_date,
        co.last_order_date_only,
        case
            when co.total_orders is null then 'Never Ordered'
            when co.total_orders = 1 then 'One-Time Customer'
            when co.total_orders between 2 and 5 then 'Repeat Customer'
            when co.total_orders > 5 then 'VIP Customer'
        end as customer_segment,
        case
            when co.last_order_date_only >= current_date - interval '30 days' then 'Active'
            when co.last_order_date_only >= current_date - interval '90 days' then 'At Risk'
            when co.last_order_date_only < current_date - interval '90 days' then 'Churned'
            else 'Never Ordered'
        end as customer_status,
        current_timestamp as dbt_loaded_at
    from customers c
    left join customer_orders co
        on c.customer_id = co.customer_id
)

select * from metrics
    );
  
  
[0m14:55:23.443400 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:55:23.444552 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m14:55:23.445790 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */

  
    
    

    create  table
      "medallion"."main_gold"."gold_daily_sales__dbt_tmp"
  
    as (
      

-- Gold layer: Daily sales metrics
-- This layer provides time-series metrics for business reporting and analysis

with orders as (
    select * from "medallion"."main_silver"."silver_orders"
),

daily_aggregates as (
    select
        order_date_only as sales_date,
        count(*) as total_orders,
        count(distinct customer_id) as unique_customers,
        sum(amount) as total_revenue,
        avg(amount) as avg_order_value,
        min(amount) as min_order_value,
        max(amount) as max_order_value,

        -- Orders by status
        count(case when status = 'PENDING' then 1 end) as pending_orders,
        count(case when status = 'PROCESSING' then 1 end) as processing_orders,
        count(case when status = 'SHIPPED' then 1 end) as shipped_orders,
        count(case when status = 'DELIVERED' then 1 end) as delivered_orders,
        count(case when status = 'CANCELLED' then 1 end) as cancelled_orders,

        -- Revenue by status
        sum(case when status = 'DELIVERED' then amount else 0 end) as delivered_revenue,
        sum(case when status = 'CANCELLED' then amount else 0 end) as cancelled_revenue

    from orders
    group by order_date_only
),

with_moving_averages as (
    select
        *,
        -- 7-day moving average
        avg(total_revenue) over (
            order by sales_date
            rows between 6 preceding and current row
        ) as revenue_7day_ma,

        -- 30-day moving average
        avg(total_revenue) over (
            order by sales_date
            rows between 29 preceding and current row
        ) as revenue_30day_ma,

        -- Day of week metrics
        dayname(sales_date) as day_of_week,
        extract(dow from sales_date) as day_of_week_num,

        current_timestamp as dbt_loaded_at

    from daily_aggregates
)

select * from with_moving_averages
order by sales_date desc
    );
  
  
[0m14:55:23.468422 [debug] [Thread-4 (]: SQL status: OK in 0.026 seconds
[0m14:55:23.478516 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m14:55:23.479312 [debug] [Thread-3 (]: SQL status: OK in 0.032 seconds
[0m14:55:23.480178 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */
alter table "medallion"."main_gold"."gold_customer_metrics__dbt_tmp" rename to "gold_customer_metrics"
[0m14:55:23.484781 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m14:55:23.486568 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */
alter table "medallion"."main_gold"."gold_daily_sales__dbt_tmp" rename to "gold_daily_sales"
[0m14:55:23.487653 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:23.489191 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:55:23.495302 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: COMMIT
[0m14:55:23.501124 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: COMMIT
[0m14:55:23.502174 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m14:55:23.503107 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m14:55:23.503944 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: COMMIT
[0m14:55:23.504742 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: COMMIT
[0m14:55:23.508032 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:55:23.513045 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.gold_daily_sales"
[0m14:55:23.514257 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_daily_sales"} */

      drop table if exists "medallion"."main_gold"."gold_daily_sales__dbt_backup" cascade
    
[0m14:55:23.515157 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m14:55:23.522468 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:55:23.524256 [debug] [Thread-4 (]: Using duckdb connection "model.medallion_project.gold_customer_metrics"
[0m14:55:23.526495 [debug] [Thread-3 (]: On model.medallion_project.gold_daily_sales: Close
[0m14:55:23.527451 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.gold_customer_metrics"} */

      drop table if exists "medallion"."main_gold"."gold_customer_metrics__dbt_backup" cascade
    
[0m14:55:23.529506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83509bf9e0>]}
[0m14:55:23.530288 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:55:23.531335 [info ] [Thread-3 (]: 8 of 8 OK created sql table model main_gold.gold_daily_sales ................... [[32mOK[0m in 2.07s]
[0m14:55:23.533571 [debug] [Thread-4 (]: On model.medallion_project.gold_customer_metrics: Close
[0m14:55:23.534629 [debug] [Thread-3 (]: Finished running node model.medallion_project.gold_daily_sales
[0m14:55:23.536370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0b172d-1259-41ba-ac2e-756899e98a91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83512c72c0>]}
[0m14:55:23.537450 [info ] [Thread-4 (]: 7 of 8 OK created sql table model main_gold.gold_customer_metrics .............. [[32mOK[0m in 2.08s]
[0m14:55:23.538531 [debug] [Thread-4 (]: Finished running node model.medallion_project.gold_customer_metrics
[0m14:55:23.540945 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:23.541730 [debug] [MainThread]: On master: BEGIN
[0m14:55:23.542455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:23.544580 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:55:23.545552 [debug] [MainThread]: On master: COMMIT
[0m14:55:23.546361 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:23.547604 [debug] [MainThread]: On master: COMMIT
[0m14:55:23.549094 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:23.549866 [debug] [MainThread]: On master: Close
[0m14:55:23.550880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:23.551572 [debug] [MainThread]: Connection 'model.medallion_project.gold_customer_metrics' was properly closed.
[0m14:55:23.552258 [debug] [MainThread]: Connection 'model.medallion_project.silver_orders' was properly closed.
[0m14:55:23.553037 [debug] [MainThread]: Connection 'model.medallion_project.bronze_orders' was properly closed.
[0m14:55:23.553637 [debug] [MainThread]: Connection 'model.medallion_project.gold_daily_sales' was properly closed.
[0m14:55:23.554857 [info ] [MainThread]: 
[0m14:55:23.555811 [info ] [MainThread]: Finished running 5 table models, 3 view models in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m14:55:23.558285 [debug] [MainThread]: Command end result
[0m14:55:23.610906 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m14:55:23.621515 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m14:55:24.099476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /content/drive/MyDrive/dbt_project/medallion_project/target/run_results.json
[0m14:55:24.100677 [info ] [MainThread]: 
[0m14:55:24.101988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:24.103073 [info ] [MainThread]: 
[0m14:55:24.104565 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:55:24.105691 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:55:24.107557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.599293, "process_in_blocks": "8576", "process_kernel_time": 0.48061, "process_mem_max_rss": "204404", "process_out_blocks": "0", "process_user_time": 8.391334}
[0m14:55:24.108708 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:24.108545 after 23.60 seconds
[0m14:55:24.109545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8358a4b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e83593783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8354181ca0>]}
[0m14:55:24.110399 [debug] [MainThread]: Flushing usage events
[0m14:55:24.457872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:18.984940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d6404aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d6344cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d633c47d0>]}


============================== 17:12:19.583486 | 3701ef68-42f8-44f0-aee5-ddcc1b74773f ==============================
[0m17:12:19.583486 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:12:19.584725 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'quiet': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/content/drive/MyDrive/dbt_project/medallion_project', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/content/drive/MyDrive/dbt_project/medallion_project/logs'}
[0m17:12:19.638633 [info ] [MainThread]: dbt version: 1.10.13
[0m17:12:19.639555 [info ] [MainThread]: python version: 3.12.12
[0m17:12:19.640287 [info ] [MainThread]: python path: /usr/bin/python3
[0m17:12:19.641154 [info ] [MainThread]: os info: Linux-6.6.105+-x86_64-with-glibc2.35
[0m17:12:19.957963 [info ] [MainThread]: Using profiles dir at /content/drive/MyDrive/dbt_project/medallion_project
[0m17:12:19.959043 [info ] [MainThread]: Using profiles.yml file at /content/drive/MyDrive/dbt_project/medallion_project/profiles.yml
[0m17:12:19.960010 [info ] [MainThread]: Using dbt_project.yml file at /content/drive/MyDrive/dbt_project/medallion_project/dbt_project.yml
[0m17:12:19.962252 [info ] [MainThread]: adapter type: duckdb
[0m17:12:19.963322 [info ] [MainThread]: adapter version: 1.9.6
[0m17:12:20.157288 [info ] [MainThread]: Configuration:
[0m17:12:20.158289 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:12:20.159129 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:12:20.159886 [info ] [MainThread]: Required dependencies:
[0m17:12:20.160636 [debug] [MainThread]: Executing "git --help"
[0m17:12:20.193760 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:12:20.195135 [debug] [MainThread]: STDERR: "b''"
[0m17:12:20.196092 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:12:20.197039 [info ] [MainThread]: Connection:
[0m17:12:20.198179 [info ] [MainThread]:   database: medallion
[0m17:12:20.198940 [info ] [MainThread]:   schema: main
[0m17:12:20.199707 [info ] [MainThread]:   path: /content/drive/MyDrive/dbt_project/dbt_duckdb/medallion.duckdb
[0m17:12:20.200492 [info ] [MainThread]:   config_options: None
[0m17:12:20.201254 [info ] [MainThread]:   extensions: ['httpfs', 'parquet', 'json']
[0m17:12:20.202165 [info ] [MainThread]:   settings: {'memory_limit': '4GB', 'temp_directory': '/tmp/duckdb_temp'}
[0m17:12:20.203060 [info ] [MainThread]:   external_root: .
[0m17:12:20.203925 [info ] [MainThread]:   use_credential_provider: None
[0m17:12:20.204839 [info ] [MainThread]:   attach: None
[0m17:12:20.205735 [info ] [MainThread]:   filesystems: None
[0m17:12:20.206456 [info ] [MainThread]:   remote: None
[0m17:12:20.207246 [info ] [MainThread]:   plugins: None
[0m17:12:20.208046 [info ] [MainThread]:   disable_transactions: False
[0m17:12:20.208977 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m17:12:20.331371 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:12:20.401295 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:12:20.402405 [debug] [MainThread]: On debug: select 1 as id
[0m17:12:20.403287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:23.613332 [debug] [MainThread]: SQL status: OK in 3.210 seconds
[0m17:12:23.615132 [debug] [MainThread]: On debug: Close
[0m17:12:23.616065 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:12:23.616828 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:12:23.618359 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.350772, "process_in_blocks": "89472", "process_kernel_time": 0.789832, "process_mem_max_rss": "290328", "process_out_blocks": "283344", "process_user_time": 6.76783}
[0m17:12:23.619569 [debug] [MainThread]: Command `dbt debug` succeeded at 17:12:23.619411 after 6.35 seconds
[0m17:12:23.620249 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:12:23.621247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d62cf7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d62c83bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d6344c2c0>]}
[0m17:12:23.622218 [debug] [MainThread]: Flushing usage events
[0m17:12:23.735556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:06.227142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac519e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac477a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac43c0a70>]}


============================== 17:14:06.232713 | ad2e0ddb-c85f-4298-80e9-e9193480dbc7 ==============================
[0m17:14:06.232713 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:06.233782 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/content/drive/MyDrive/dbt_project/medallion_project/logs', 'invocation_command': 'dbt run --select silver --vars {execution_date: "2023-01-01"}', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/content/drive/MyDrive/dbt_project/medallion_project', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:14:06.797810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abfe18500>]}
[0m17:14:06.958357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac6ac4350>]}
[0m17:14:06.961785 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m17:14:07.174128 [debug] [MainThread]: checksum: 23669494d6347a1d909c6e188b053e95f3610fe8d393bc08d6c3f2ee1f040eaa, vars: {'execution_date': '2023-01-01'}, profile: , target: , version: 1.10.13
[0m17:14:07.814823 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:14:07.815964 [debug] [MainThread]: previous checksum: 23669494d6347a1d909c6e188b053e95f3610fe8d393bc08d6c3f2ee1f040eaa, current checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe
[0m17:14:07.816816 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:14:07.817678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac4612930>]}
[0m17:14:16.189567 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:14:16.190657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abf936ab0>]}
[0m17:14:16.547187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abf12ce60>]}
[0m17:14:17.185475 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m17:14:17.629259 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m17:14:18.348736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abf0a7410>]}
[0m17:14:18.350067 [info ] [MainThread]: Found 8 models, 1 snapshot, 56 data tests, 2 sources, 444 macros
[0m17:14:18.350877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abf0c3380>]}
[0m17:14:18.353922 [info ] [MainThread]: 
[0m17:14:18.354693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:18.355335 [info ] [MainThread]: 
[0m17:14:18.356286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:14:18.362352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m17:14:18.403817 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m17:14:18.404746 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m17:14:18.405536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.753771 [debug] [ThreadPool]: SQL status: OK in 0.348 seconds
[0m17:14:18.756102 [debug] [ThreadPool]: On list_medallion: Close
[0m17:14:18.757620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_main_silver)
[0m17:14:18.758591 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "main_silver"
"
[0m17:14:18.767243 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m17:14:18.768110 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m17:14:18.768869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:18.771167 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:18.773201 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m17:14:18.773934 [debug] [ThreadPool]: On create_medallion_main_silver: BEGIN
[0m17:14:18.774833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:18.775480 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m17:14:18.776268 [debug] [ThreadPool]: On create_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_main_silver"} */

    
    
        create schema if not exists "medallion"."main_silver"
    
[0m17:14:18.777450 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:18.778977 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m17:14:18.779664 [debug] [ThreadPool]: Using duckdb connection "create_medallion_main_silver"
[0m17:14:18.780289 [debug] [ThreadPool]: On create_medallion_main_silver: COMMIT
[0m17:14:18.781194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:18.781861 [debug] [ThreadPool]: On create_medallion_main_silver: Close
[0m17:14:18.784454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_main_silver, now list_medallion_main)
[0m17:14:18.785354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main_gold'
[0m17:14:18.791409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_silver'
[0m17:14:18.793936 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main_silver'
[0m17:14:18.801190 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:14:18.799449 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m17:14:18.804426 [debug] [ThreadPool]: Using duckdb connection "list_medallion_silver"
[0m17:14:18.807292 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m17:14:18.808552 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:14:18.809457 [debug] [ThreadPool]: On list_medallion_main_gold: BEGIN
[0m17:14:18.810538 [debug] [ThreadPool]: On list_medallion_silver: BEGIN
[0m17:14:18.811470 [debug] [ThreadPool]: On list_medallion_main_silver: BEGIN
[0m17:14:18.812250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:18.813005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.813704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.814372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:18.816431 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:14:18.818686 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:14:18.817413 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:14:18.819460 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:18.820356 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:14:18.823113 [debug] [ThreadPool]: Using duckdb connection "list_medallion_silver"
[0m17:14:18.821391 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:14:18.824075 [debug] [ThreadPool]: On list_medallion_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:18.821929 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m17:14:18.828718 [debug] [ThreadPool]: On list_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_gold"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:18.825014 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m17:14:18.831027 [debug] [ThreadPool]: On list_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:18.865707 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m17:14:18.868372 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m17:14:18.869719 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m17:14:18.872957 [debug] [ThreadPool]: On list_medallion_main_gold: ROLLBACK
[0m17:14:18.874003 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m17:14:18.875825 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:14:18.883622 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:14:18.879161 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_gold'
[0m17:14:18.881136 [debug] [ThreadPool]: On list_medallion_main_silver: ROLLBACK
[0m17:14:18.877572 [debug] [ThreadPool]: On list_medallion_silver: ROLLBACK
[0m17:14:18.885428 [debug] [ThreadPool]: On list_medallion_main_gold: Close
[0m17:14:18.884573 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:14:18.890655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion_main, now list_medallion_main_bronze)
[0m17:14:18.888949 [debug] [ThreadPool]: Failed to rollback 'list_medallion_silver'
[0m17:14:18.887306 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_silver'
[0m17:14:18.894635 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m17:14:18.895346 [debug] [ThreadPool]: On list_medallion_silver: Close
[0m17:14:18.896052 [debug] [ThreadPool]: On list_medallion_main_silver: Close
[0m17:14:18.896730 [debug] [ThreadPool]: On list_medallion_main_bronze: BEGIN
[0m17:14:18.898831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:18.900424 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:18.901048 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m17:14:18.901694 [debug] [ThreadPool]: On list_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_bronze"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:18.906546 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:14:18.908511 [debug] [ThreadPool]: On list_medallion_main_bronze: ROLLBACK
[0m17:14:18.909987 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_bronze'
[0m17:14:18.910719 [debug] [ThreadPool]: On list_medallion_main_bronze: Close
[0m17:14:18.912711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abe56a990>]}
[0m17:14:18.913621 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:18.914256 [debug] [MainThread]: On master: BEGIN
[0m17:14:18.914873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:18.916495 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:18.917109 [debug] [MainThread]: On master: COMMIT
[0m17:14:18.917772 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:18.918488 [debug] [MainThread]: On master: COMMIT
[0m17:14:18.919335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:18.920068 [debug] [MainThread]: On master: Close
[0m17:14:18.923307 [debug] [Thread-1 (]: Began running node model.medallion_project.silver_customers
[0m17:14:18.924287 [info ] [Thread-1 (]: 1 of 2 START sql table model main_silver.silver_customers ...................... [RUN]
[0m17:14:18.925180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_silver, now model.medallion_project.silver_customers)
[0m17:14:18.926040 [debug] [Thread-1 (]: Began compiling node model.medallion_project.silver_customers
[0m17:14:18.936089 [debug] [Thread-1 (]: Writing injected SQL for node "model.medallion_project.silver_customers"
[0m17:14:20.391274 [debug] [Thread-1 (]: Began executing node model.medallion_project.silver_customers
[0m17:14:20.455416 [debug] [Thread-1 (]: Writing runtime sql for node "model.medallion_project.silver_customers"
[0m17:14:21.863057 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.864047 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: BEGIN
[0m17:14:21.865219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:21.867420 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:14:21.868323 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.869401 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

  
    
    

    create  table
      "medallion"."main_silver"."silver_customers__dbt_tmp"
  
    as (
      

-- Silver layer: Cleaned and standardized customer data
-- This layer applies data quality rules and standardization

with source as (
    select * from "medallion"."main_bronze"."bronze_customers"
),

cleaned as (
    select
        customer_id,
        lower(trim(email)) as email,
        trim(first_name) as first_name,
        trim(last_name) as last_name,
        first_name || ' ' || last_name as full_name,
        created_at,
        updated_at,
        current_timestamp as dbt_loaded_at
    from source
    where
        -- Data quality filters
        customer_id is not null
        and email is not null
        and email like '%@%.%'  -- Basic email validation
        and first_name is not null
        and last_name is not null
)

select * from cleaned
    );
  
  
[0m17:14:21.882066 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:14:21.889536 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.890537 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_customers'
  
[0m17:14:21.892184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:21.894169 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.894974 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_silver'
      AND table_name = 'silver_customers'
  
[0m17:14:21.899372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:14:21.908151 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.909064 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */
alter table "medallion"."main_silver"."silver_customers" rename to "silver_customers__dbt_backup"
[0m17:14:21.910467 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:21.914917 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.915720 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */
alter table "medallion"."main_silver"."silver_customers__dbt_tmp" rename to "silver_customers"
[0m17:14:21.917270 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:21.936987 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: COMMIT
[0m17:14:21.938001 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.938831 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: COMMIT
[0m17:14:21.947823 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m17:14:21.958145 [debug] [Thread-1 (]: Using duckdb connection "model.medallion_project.silver_customers"
[0m17:14:21.959264 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_customers"} */

      drop table if exists "medallion"."main_silver"."silver_customers__dbt_backup" cascade
    
[0m17:14:21.961086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:21.964678 [debug] [Thread-1 (]: On model.medallion_project.silver_customers: Close
[0m17:14:21.967339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac4ee5dc0>]}
[0m17:14:21.968541 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main_silver.silver_customers ................. [[32mOK[0m in 3.04s]
[0m17:14:21.969741 [debug] [Thread-1 (]: Finished running node model.medallion_project.silver_customers
[0m17:14:21.970922 [debug] [Thread-3 (]: Began running node model.medallion_project.silver_orders
[0m17:14:21.971955 [info ] [Thread-3 (]: 2 of 2 START sql incremental model main_silver.silver_orders ................... [RUN]
[0m17:14:21.973133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_medallion_main_silver, now model.medallion_project.silver_orders)
[0m17:14:21.974189 [debug] [Thread-3 (]: Began compiling node model.medallion_project.silver_orders
[0m17:14:21.982657 [debug] [Thread-3 (]: Writing injected SQL for node "model.medallion_project.silver_orders"
[0m17:14:22.483535 [debug] [Thread-3 (]: Began executing node model.medallion_project.silver_orders
[0m17:14:22.524444 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:22.525512 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

    
  
    
    

    create temporary table
      "silver_orders__dbt_tmp20251026171422519460"
  
    as (
      

-- Silver layer: Cleaned and standardized order data
-- This layer applies data quality rules and enriches with customer information

with source as (
    select * from "medallion"."main_bronze"."bronze_orders"
    
    where created_at::date = CAST('2023-01-01' AS DATE)
    
),

customers as (
    select customer_id from "medallion"."main_silver"."silver_customers"
),

cleaned as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        cast(o.order_date as date) as order_date_only,
        o.amount,
        upper(trim(o.status)) as status,
        o.created_at,
        o.updated_at,
        current_timestamp as dbt_loaded_at
    from source o
    inner join customers c
        on o.customer_id = c.customer_id
    where
        -- Data quality filters
        o.order_id is not null
        and o.customer_id is not null
        and o.order_date is not null
        and o.amount is not null
        and o.amount > 0
        and o.status is not null
)

select * from cleaned
    );
  
  
  
[0m17:14:22.526406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:14:22.535856 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:14:22.546566 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:22.547571 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: BEGIN
[0m17:14:22.548823 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:14:22.549603 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:22.550632 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_orders__dbt_tmp20251026171422519460'
      
      
      order by ordinal_position

  
[0m17:14:22.555926 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:14:22.563689 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:22.564643 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_orders'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'medallion'
      
      order by ordinal_position

  
[0m17:14:22.568615 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:14:22.578267 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:22.579235 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'silver_orders'
      
      and lower(table_schema) = 'main_silver'
      
      
      and lower(table_catalog) = 'medallion'
      
      order by ordinal_position

  
[0m17:14:22.583259 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:14:22.603764 [debug] [Thread-3 (]: Writing runtime sql for node "model.medallion_project.silver_orders"
[0m17:14:23.049593 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:23.050863 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "model.medallion_project.silver_orders"} */

        
            delete from "medallion"."main_silver"."silver_orders"
            where (
                order_id) in (
                select (order_id)
                from "silver_orders__dbt_tmp20251026171422519460"
            );

        
    

    insert into "medallion"."main_silver"."silver_orders" ("order_id", "customer_id", "order_date", "order_date_only", "amount", "status", "created_at", "updated_at", "dbt_loaded_at")
    (
        select "order_id", "customer_id", "order_date", "order_date_only", "amount", "status", "created_at", "updated_at", "dbt_loaded_at"
        from "silver_orders__dbt_tmp20251026171422519460"
    )
  
[0m17:14:23.055674 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:14:23.058201 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: COMMIT
[0m17:14:23.059002 [debug] [Thread-3 (]: Using duckdb connection "model.medallion_project.silver_orders"
[0m17:14:23.059729 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: COMMIT
[0m17:14:23.063263 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:14:23.064714 [debug] [Thread-3 (]: On model.medallion_project.silver_orders: Close
[0m17:14:23.066348 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2e0ddb-c85f-4298-80e9-e9193480dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abf3f4a40>]}
[0m17:14:23.067550 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model main_silver.silver_orders .............. [[32mOK[0m in 1.09s]
[0m17:14:23.068670 [debug] [Thread-3 (]: Finished running node model.medallion_project.silver_orders
[0m17:14:23.070860 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:23.071600 [debug] [MainThread]: On master: BEGIN
[0m17:14:23.072268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:23.074187 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:23.074891 [debug] [MainThread]: On master: COMMIT
[0m17:14:23.075564 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:23.076439 [debug] [MainThread]: On master: COMMIT
[0m17:14:23.077456 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:23.078105 [debug] [MainThread]: On master: Close
[0m17:14:23.078962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:23.079573 [debug] [MainThread]: Connection 'list_medallion_main_bronze' was properly closed.
[0m17:14:23.080164 [debug] [MainThread]: Connection 'list_medallion_main_gold' was properly closed.
[0m17:14:23.080793 [debug] [MainThread]: Connection 'model.medallion_project.silver_customers' was properly closed.
[0m17:14:23.081398 [debug] [MainThread]: Connection 'model.medallion_project.silver_orders' was properly closed.
[0m17:14:23.082072 [info ] [MainThread]: 
[0m17:14:23.082767 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m17:14:23.084097 [debug] [MainThread]: Command end result
[0m17:14:23.131780 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m17:14:23.143123 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m17:14:23.463723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /content/drive/MyDrive/dbt_project/medallion_project/target/run_results.json
[0m17:14:23.464677 [info ] [MainThread]: 
[0m17:14:23.465679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:23.466468 [info ] [MainThread]: 
[0m17:14:23.467562 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:14:23.468563 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:14:23.470052 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.351662, "process_in_blocks": "7696", "process_kernel_time": 0.41337, "process_mem_max_rss": "205108", "process_out_blocks": "0", "process_user_time": 8.030205}
[0m17:14:23.471116 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:23.470957 after 17.35 seconds
[0m17:14:23.471919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac40cde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1abfe1b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ac43c0a70>]}
[0m17:14:23.472691 [debug] [MainThread]: Flushing usage events
[0m17:14:23.587254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:37.591008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbd8b6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbd510380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbdce91f0>]}


============================== 17:14:37.596959 | 353980e7-675c-4773-890b-ca3dacec72bf ==============================
[0m17:14:37.596959 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:14:37.598036 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt snapshot --select silver --vars {execution_date: "2023-01-01"}', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/content/drive/MyDrive/dbt_project/medallion_project/logs', 'introspect': 'True', 'debug': 'False', 'empty': 'False', 'profiles_dir': '/content/drive/MyDrive/dbt_project/medallion_project', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m17:14:37.979083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbd2ebef0>]}
[0m17:14:38.089301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fb920fb00>]}
[0m17:14:38.091944 [info ] [MainThread]: Registered adapter: duckdb=1.9.6
[0m17:14:38.242268 [debug] [MainThread]: checksum: 23669494d6347a1d909c6e188b053e95f3610fe8d393bc08d6c3f2ee1f040eaa, vars: {'execution_date': '2023-01-01'}, profile: , target: , version: 1.10.13
[0m17:14:38.498079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:38.499032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:38.693717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fb908c290>]}
[0m17:14:38.848337 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m17:14:38.860232 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m17:14:38.899828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbd2c0f50>]}
[0m17:14:38.900871 [info ] [MainThread]: Found 8 models, 1 snapshot, 56 data tests, 2 sources, 444 macros
[0m17:14:38.902003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fb9396810>]}
[0m17:14:38.905460 [info ] [MainThread]: 
[0m17:14:38.906274 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:14:38.906977 [info ] [MainThread]: 
[0m17:14:38.907917 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:14:38.909369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion'
[0m17:14:38.952177 [debug] [ThreadPool]: Using duckdb connection "list_medallion"
[0m17:14:38.953135 [debug] [ThreadPool]: On list_medallion: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"medallion"'
    
  
  
[0m17:14:38.954042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:39.293401 [debug] [ThreadPool]: SQL status: OK in 0.339 seconds
[0m17:14:39.295657 [debug] [ThreadPool]: On list_medallion: Close
[0m17:14:39.297182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion, now create_medallion_silver)
[0m17:14:39.298190 [debug] [ThreadPool]: Creating schema "database: "medallion"
schema: "silver"
"
[0m17:14:39.307926 [debug] [ThreadPool]: Using duckdb connection "create_medallion_silver"
[0m17:14:39.308853 [debug] [ThreadPool]: On create_medallion_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='medallion'
        and type='sqlite'
    
  
[0m17:14:39.309597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:39.311790 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:39.313750 [debug] [ThreadPool]: Using duckdb connection "create_medallion_silver"
[0m17:14:39.314413 [debug] [ThreadPool]: On create_medallion_silver: BEGIN
[0m17:14:39.315301 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:39.315957 [debug] [ThreadPool]: Using duckdb connection "create_medallion_silver"
[0m17:14:39.316577 [debug] [ThreadPool]: On create_medallion_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "create_medallion_silver"} */

    
    
        create schema if not exists "medallion"."silver"
    
[0m17:14:39.317545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:14:39.318890 [debug] [ThreadPool]: On create_medallion_silver: COMMIT
[0m17:14:39.319569 [debug] [ThreadPool]: Using duckdb connection "create_medallion_silver"
[0m17:14:39.320187 [debug] [ThreadPool]: On create_medallion_silver: COMMIT
[0m17:14:39.325028 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:14:39.326745 [debug] [ThreadPool]: On create_medallion_silver: Close
[0m17:14:39.335621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_medallion_silver, now list_medallion_main_gold)
[0m17:14:39.343369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main'
[0m17:14:39.344336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_main_silver'
[0m17:14:39.351469 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m17:14:39.352012 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:14:39.354622 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m17:14:39.355321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_medallion_silver'
[0m17:14:39.356092 [debug] [ThreadPool]: On list_medallion_main_gold: BEGIN
[0m17:14:39.356829 [debug] [ThreadPool]: On list_medallion_main: BEGIN
[0m17:14:39.357520 [debug] [ThreadPool]: On list_medallion_main_silver: BEGIN
[0m17:14:39.360207 [debug] [ThreadPool]: Using duckdb connection "list_medallion_silver"
[0m17:14:39.361043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:39.361769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:39.362594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:39.363390 [debug] [ThreadPool]: On list_medallion_silver: BEGIN
[0m17:14:39.365754 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:39.366635 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:39.367978 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:39.368632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:39.369320 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_gold"
[0m17:14:39.370094 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main"
[0m17:14:39.372665 [debug] [ThreadPool]: On list_medallion_main: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:39.373623 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m17:14:39.370809 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_silver"
[0m17:14:39.371851 [debug] [ThreadPool]: On list_medallion_main_gold: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_gold"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:39.374538 [debug] [ThreadPool]: Using duckdb connection "list_medallion_silver"
[0m17:14:39.376816 [debug] [ThreadPool]: On list_medallion_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'silver'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:39.375539 [debug] [ThreadPool]: On list_medallion_main_silver: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_silver"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:39.405109 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m17:14:39.406141 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m17:14:39.407000 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m17:14:39.407692 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m17:14:39.409562 [debug] [ThreadPool]: On list_medallion_main_silver: ROLLBACK
[0m17:14:39.411801 [debug] [ThreadPool]: On list_medallion_main: ROLLBACK
[0m17:14:39.413611 [debug] [ThreadPool]: On list_medallion_main_gold: ROLLBACK
[0m17:14:39.415255 [debug] [ThreadPool]: On list_medallion_silver: ROLLBACK
[0m17:14:39.416937 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_silver'
[0m17:14:39.418325 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main'
[0m17:14:39.419794 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_gold'
[0m17:14:39.421020 [debug] [ThreadPool]: Failed to rollback 'list_medallion_silver'
[0m17:14:39.421713 [debug] [ThreadPool]: On list_medallion_main_silver: Close
[0m17:14:39.422439 [debug] [ThreadPool]: On list_medallion_main: Close
[0m17:14:39.425731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medallion_main_silver, now list_medallion_main_bronze)
[0m17:14:39.423926 [debug] [ThreadPool]: On list_medallion_silver: Close
[0m17:14:39.423224 [debug] [ThreadPool]: On list_medallion_main_gold: Close
[0m17:14:39.429895 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m17:14:39.432118 [debug] [ThreadPool]: On list_medallion_main_bronze: BEGIN
[0m17:14:39.432787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:14:39.434480 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:14:39.435120 [debug] [ThreadPool]: Using duckdb connection "list_medallion_main_bronze"
[0m17:14:39.435820 [debug] [ThreadPool]: On list_medallion_main_bronze: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "connection_name": "list_medallion_main_bronze"} */
select
      'medallion' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'medallion'
  
[0m17:14:39.440256 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:14:39.442323 [debug] [ThreadPool]: On list_medallion_main_bronze: ROLLBACK
[0m17:14:39.443755 [debug] [ThreadPool]: Failed to rollback 'list_medallion_main_bronze'
[0m17:14:39.444446 [debug] [ThreadPool]: On list_medallion_main_bronze: Close
[0m17:14:39.446524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbfea3530>]}
[0m17:14:39.447503 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:39.448179 [debug] [MainThread]: On master: BEGIN
[0m17:14:39.448853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:39.450478 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:39.451140 [debug] [MainThread]: On master: COMMIT
[0m17:14:39.452014 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:39.452705 [debug] [MainThread]: On master: COMMIT
[0m17:14:39.453668 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:39.454370 [debug] [MainThread]: On master: Close
[0m17:14:39.457985 [debug] [Thread-1 (]: Began running node snapshot.medallion_project.silver_customers_snapshot
[0m17:14:39.459055 [info ] [Thread-1 (]: 1 of 1 START snapshot silver.silver_customers_snapshot ......................... [RUN]
[0m17:14:39.460029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_medallion_main_bronze, now snapshot.medallion_project.silver_customers_snapshot)
[0m17:14:39.460857 [debug] [Thread-1 (]: Began compiling node snapshot.medallion_project.silver_customers_snapshot
[0m17:14:39.471578 [debug] [Thread-1 (]: Began executing node snapshot.medallion_project.silver_customers_snapshot
[0m17:14:39.559554 [debug] [Thread-1 (]: Using duckdb connection "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.560735 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "snapshot.medallion_project.silver_customers_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



with source as (
    select * from "medallion"."main_bronze"."bronze_customers"
    where created_at::date = CAST('2023-01-01' AS DATE)
),

cleaned as (
    select
        customer_id,
        lower(trim(email)) as email,
        trim(first_name) as first_name,
        trim(last_name) as last_name,
        first_name || ' ' || last_name as full_name,
        created_at,
        updated_at,
        current_timestamp as dbt_loaded_at
    from source
    where
        -- Data quality filters
        customer_id is not null
        and email is not null
        and email like '%@%.%'  -- Basic email validation
        and first_name is not null
        and last_name is not null
)

select * from cleaned

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m17:14:39.561742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:39.565370 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:14:39.572775 [debug] [Thread-1 (]: Using duckdb connection "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.573684 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "snapshot.medallion_project.silver_customers_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m17:14:39.575500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:39.576287 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (TIMESTAMP) doesn't match derived column 'updated_at' (TIMESTAMP_NS). Please update snapshot config 'updated_at'.
[0m17:14:39.577312 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.591596 [debug] [Thread-1 (]: Using duckdb connection "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.592937 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: BEGIN
[0m17:14:39.594466 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:14:39.595659 [debug] [Thread-1 (]: Using duckdb connection "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.597003 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "medallion_duckdb", "target_name": "dev", "node_id": "snapshot.medallion_project.silver_customers_snapshot"} */

      
  
    
    

    create  table
      "medallion"."silver"."silver_customers_snapshot"
  
    as (
      
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
from (
        



with source as (
    select * from "medallion"."main_bronze"."bronze_customers"
    where created_at::date = CAST('2023-01-01' AS DATE)
),

cleaned as (
    select
        customer_id,
        lower(trim(email)) as email,
        trim(first_name) as first_name,
        trim(last_name) as last_name,
        first_name || ' ' || last_name as full_name,
        created_at,
        updated_at,
        current_timestamp as dbt_loaded_at
    from source
    where
        -- Data quality filters
        customer_id is not null
        and email is not null
        and email like '%@%.%'  -- Basic email validation
        and first_name is not null
        and last_name is not null
)

select * from cleaned

    ) sbq



    );
  
  
  
[0m17:14:39.603137 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:14:39.622496 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: COMMIT
[0m17:14:39.623549 [debug] [Thread-1 (]: Using duckdb connection "snapshot.medallion_project.silver_customers_snapshot"
[0m17:14:39.624390 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: COMMIT
[0m17:14:39.626332 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:14:39.628855 [debug] [Thread-1 (]: On snapshot.medallion_project.silver_customers_snapshot: Close
[0m17:14:39.631735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '353980e7-675c-4773-890b-ca3dacec72bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbe2f0da0>]}
[0m17:14:39.633189 [info ] [Thread-1 (]: 1 of 1 OK snapshotted silver.silver_customers_snapshot ......................... [[32mOK[0m in 0.17s]
[0m17:14:39.634412 [debug] [Thread-1 (]: Finished running node snapshot.medallion_project.silver_customers_snapshot
[0m17:14:39.636756 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:39.637655 [debug] [MainThread]: On master: BEGIN
[0m17:14:39.638365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:39.640106 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:14:39.640842 [debug] [MainThread]: On master: COMMIT
[0m17:14:39.641505 [debug] [MainThread]: Using duckdb connection "master"
[0m17:14:39.642128 [debug] [MainThread]: On master: COMMIT
[0m17:14:39.643026 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:14:39.643741 [debug] [MainThread]: On master: Close
[0m17:14:39.644611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:39.645222 [debug] [MainThread]: Connection 'list_medallion_main_gold' was properly closed.
[0m17:14:39.645827 [debug] [MainThread]: Connection 'list_medallion_main' was properly closed.
[0m17:14:39.646430 [debug] [MainThread]: Connection 'snapshot.medallion_project.silver_customers_snapshot' was properly closed.
[0m17:14:39.647016 [debug] [MainThread]: Connection 'list_medallion_silver' was properly closed.
[0m17:14:39.647715 [info ] [MainThread]: 
[0m17:14:39.648420 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:14:39.649559 [debug] [MainThread]: Command end result
[0m17:14:39.694701 [debug] [MainThread]: Wrote artifact WritableManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/manifest.json
[0m17:14:39.708034 [debug] [MainThread]: Wrote artifact SemanticManifest to /content/drive/MyDrive/dbt_project/medallion_project/target/semantic_manifest.json
[0m17:14:39.723723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /content/drive/MyDrive/dbt_project/medallion_project/target/run_results.json
[0m17:14:39.724684 [info ] [MainThread]: 
[0m17:14:39.725967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:39.726745 [info ] [MainThread]: 
[0m17:14:39.727487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:14:39.728959 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 2.2459688, "process_in_blocks": "224", "process_kernel_time": 0.415239, "process_mem_max_rss": "185092", "process_out_blocks": "0", "process_user_time": 5.495032}
[0m17:14:39.729833 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:14:39.729684 after 2.25 seconds
[0m17:14:39.730583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fbd721970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fb8d0a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781fb8d0be30>]}
[0m17:14:39.731446 [debug] [MainThread]: Flushing usage events
[0m17:14:39.819119 [debug] [MainThread]: An error was encountered while trying to flush usage events
